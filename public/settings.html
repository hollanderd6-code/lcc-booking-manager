// ========================================
// CONFIGURATION & STATE
// ========================================
const API_URL = "https://lcc-booking-manager.onrender.com";
let properties = [];
let currentEditingProperty = null;

// ========================================
// INITIALIZATION
// ========================================
document.addEventListener("DOMContentLoaded", async () => {
  console.log("üîß Param√®tres - Initialisation...");

  setupColorPicker();
  await loadProperties();

  console.log("‚úÖ Param√®tres initialis√©s");

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});

// ========================================
// API CALLS
// ========================================
async function loadProperties() {
  showLoading();

  try {
    const token = localStorage.getItem("lcc_token");

    const response = await fetch(`${API_URL
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}/api/properties`, {
      headers: {
        Authorization: "Bearer " + token,
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

},
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});

    const data = await response.json();
    properties = data.properties || [];
    renderProperties();

    console.log(`üì¶ ${properties.length
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} logement(s) charg√©(s)`);
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} catch (error) {
    console.error("Erreur chargement logements:", error);
    showToast("Erreur lors du chargement des logements", "error");
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} finally {
    hideLoading();
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

async function saveProperty(event) {
  event.preventDefault();
  showLoading();

  const propertyId = document.getElementById("propertyId").value;
  const name = document.getElementById("propertyName").value;
  const color = document.getElementById("propertyColor").value;

  const urlInputs = document.querySelectorAll(".url-input");
  const icalUrls = Array.from(urlInputs)
    .map((input) => input.value.trim())
    .filter((url) => url.length > 0);

  const address = document.getElementById("propertyAddress").value;
const checkIn = document.getElementById("propertyCheckIn").value;
const checkOut = document.getElementById("propertyCheckOut").value;
const deposit = document.getElementById("propertyDeposit").value;
const propertyData = { name, color, icalUrls, address, checkIn, checkOut, deposit 
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

};

  try {
    const token = localStorage.getItem("lcc_token");
    let response;

    if (propertyId) {
      response = await fetch(`${API_URL
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}/api/properties/${propertyId
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + token,
        
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

},
        body: JSON.stringify(propertyData),
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} else {
      response = await fetch(`${API_URL
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}/api/properties`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + token,
        
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

},
        body: JSON.stringify(propertyData),
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

    const result = await response.json();

    if (response.ok) {
      showToast(result.message || "Logement enregistr√©", "success");
      closeEditModal();
      await loadProperties();
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} else {
      showToast(result.error || "Erreur lors de l'enregistrement", "error");
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} catch (error) {
    console.error("Erreur sauvegarde:", error);
    showToast("Erreur lors de l'enregistrement", "error");
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} finally {
    hideLoading();
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

async function deleteProperty(propertyId, propertyName) {
  if (
    !confirm(
      `√ätes-vous s√ªr de vouloir supprimer "${propertyName
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}" ?\n\nToutes les r√©servations associ√©es seront √©galement supprim√©es.`
    )
  ) {
    return;
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

  showLoading();

  try {
    const token = localStorage.getItem("lcc_token");

    const response = await fetch(`${API_URL
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}/api/properties/${propertyId
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}`, {
      method: "DELETE",
      headers: {
        Authorization: "Bearer " + token,
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

},
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});

    const result = await response.json();

    if (response.ok) {
      showToast(result.message || "Logement supprim√©", "success");
      await loadProperties();
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} else {
      showToast(result.error || "Erreur lors de la suppression", "error");
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} catch (error) {
    console.error("Erreur suppression:", error);
    showToast("Erreur lors de la suppression", "error");
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} finally {
    hideLoading();
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

async function testIcalUrl(url, buttonElement) {
  if (!url || url.trim().length === 0) {
    showToast("Veuillez entrer une URL", "error");
    return;
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

  const originalText = buttonElement.innerHTML;
  buttonElement.innerHTML =
    '<i class="fas fa-spinner fa-spin"></i> Test...';
  buttonElement.disabled = true;

  try {
    const token = localStorage.getItem("lcc_token");

    const response = await fetch(`${API_URL
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}/api/properties/test-ical`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: "Bearer " + token,
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

},
      body: JSON.stringify({ url: url.trim() 
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}),
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});

    const result = await response.json();

    const resultDiv = document.createElement("div");
    resultDiv.className = `test-result ${
      result.success ? "success" : "error"
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}`;

    if (result.success) {
      resultDiv.innerHTML = `
        <i class="fas fa-check-circle"></i>
        URL valide ! ${result.reservationCount
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} r√©servation(s) trouv√©e(s)
      `;
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} else {
      resultDiv.innerHTML = `
        <i class="fas fa-exclamation-circle"></i>
        ${result.error || "URL invalide"
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
      `;
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

    const parent = buttonElement.parentElement;
    const existingResult = parent.querySelector(".test-result");
    if (existingResult) existingResult.remove();
    parent.appendChild(resultDiv);

    setTimeout(() => resultDiv.remove(), 5000);
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} catch (error) {
    console.error("Erreur test URL:", error);
    showToast("Erreur lors du test de l'URL", "error");
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} finally {
    buttonElement.innerHTML = originalText;
    buttonElement.disabled = false;
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

// ========================================
// UI RENDERING
// ========================================

function renderProperties() {
  const grid = document.getElementById("propertiesGrid");

  if (!properties.length) {
    grid.innerHTML = `
      <div class="empty-state">
        <i class="fas fa-home"></i>
        <p>Aucun logement configur√©</p>
        <p style="font-size: 14px; margin-top: 8px;">Cliquez sur "Ajouter un logement" pour commencer</p>
      </div>
    `;
    return;
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

  grid.innerHTML = properties
    .map(
      (property) => `
    <div class="property-card" style="border-left-color: ${
      property.color
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}">
      <div class="property-header">
        <div class="property-info">
          <div class="property-name">
            <div class="color-badge" style="background-color: ${
              property.color
            
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}"></div>
            ${property.name
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
          </div>
          <div class="property-meta">
            ${property.reservationCount || 0
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} r√©servation(s) ‚Ä¢ 
            ${property.icalUrls.length
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} source(s) iCal
          </div>
        </div>
        <div class="property-actions">
          <button class="btn-icon-action btn-edit" 
                  onclick="openEditPropertyModal('${property.id
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}')"
                  title="Modifier">
            <i class="fas fa-edit"></i>
          </button>
          <button class="btn-icon-action btn-delete" 
                  onclick="deleteProperty('${property.id
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}', '${property.name.replace(
                    /'/g,
                    "\\'"
                  )
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}')"
                  title="Supprimer">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
      
      ${
        property.icalUrls.length > 0
          ? `
        <div class="ical-urls">
          ${property.icalUrls
            .map(
              (urlData) => `
            <div class="ical-url-item">
              <i class="fas fa-link"></i>
              <span class="ical-source">${urlData.source || "URL"
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}</span>
              <span class="ical-url-text" title="${urlData.url
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}">${urlData.url
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}</span>
            </div>
          `
            )
            .join("")
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
        </div>
      `
          : `
        <div style="padding: 12px; background: var(--bg-secondary); border-radius: var(--radius-sm); text-align: center; color: var(--text-secondary); font-size: 14px;">
          <i class="fas fa-exclamation-triangle"></i>
          Aucune URL iCal configur√©e
        </div>
      `
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
    </div>
  `
    )
    .join("");

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

// ========================================
// MODAL MANAGEMENT
// ========================================

function openAddPropertyModal() {
  currentEditingProperty = null;

  document.getElementById("modalTitle").textContent =
    "Ajouter un logement";
  document.getElementById("propertyId").value = "";
  document.getElementById("propertyName").value = "";
  document.getElementById("propertyColor").value = "#E67E50";
  document.getElementById("colorPreview").textContent = "#E67E50";

  const urlList = document.getElementById("urlList");
  urlList.innerHTML = "";
  addUrlField();

  document
    .getElementById("editPropertyModal")
    .classList.add("active");

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function openEditPropertyModal(propertyId) {
  const property = properties.find((p) => p.id === propertyId);
  if (!property) return;

  currentEditingProperty = property;

  document.getElementById("modalTitle").textContent =
    "Modifier le logement";
  document.getElementById("propertyId").value = property.id;
  document.getElementById("propertyName").value = property.name;
  document.getElementById("propertyColor").value = property.color;
  document.getElementById("colorPreview").textContent = property.color;

  const urlList = document.getElementById("urlList");
  urlList.innerHTML = "";

  (property.icalUrls || []).forEach((urlData) => {
    addUrlField(urlData.url);
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});

  if (!property.icalUrls || property.icalUrls.length === 0) {
    addUrlField();
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

  document
    .getElementById("editPropertyModal")
    .classList.add("active");

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function closeEditModal() {
  document
    .getElementById("editPropertyModal")
    .classList.remove("active");
  currentEditingProperty = null;

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function setupColorPicker() {
  const colorPicker = document.getElementById("propertyColor");
  const colorPreview = document.getElementById("colorPreview");

  colorPicker.addEventListener("input", (e) => {
    colorPreview.textContent = e.target.value.toUpperCase();
    colorPreview.style.color = e.target.value;
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function addUrlField(value = "") {
  const urlList = document.getElementById("urlList");

  const urlGroup = document.createElement("div");
  urlGroup.className = "url-input-group";
  urlGroup.innerHTML = `
    <input type="url" 
           class="url-input" 
           placeholder="https://www.airbnb.fr/calendar/ical/..." 
           value="${value
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}">
    <button type="button" 
            class="btn-test-url" 
            onclick="testIcalUrl(this.previousElementSibling.value, this)"
            title="Tester l'URL">
      <i class="fas fa-check"></i> Tester
    </button>
    <button type="button" class="btn-remove-url" onclick="removeUrlField(this)">
      <i class="fas fa-times"></i>
    </button>
  `;

  urlList.appendChild(urlGroup);

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function removeUrlField(button) {
  const urlGroup = button.parentElement;
  const urlList = document.getElementById("urlList");

  if (urlList.children.length > 1) {
    urlGroup.remove();
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} else {
    showToast("Vous devez avoir au moins un champ URL", "error");
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

// ========================================
// UTILITIES
// ========================================

function showLoading() {
  document
    .getElementById("loadingOverlay")
    .classList.add("active");

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function hideLoading() {
  document
    .getElementById("loadingOverlay")
    .classList.remove("active");

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function showToast(message, type = "info") {
  const container = document.getElementById("toastContainer");
  if (!container) return;

  const icons = {
    success: "fa-check-circle",
    error: "fa-exclamation-circle",
    info: "fa-info-circle",
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

};

  const toast = document.createElement("div");
  toast.className = `toast ${type
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}`;
  toast.innerHTML = `
    <i class="fas ${icons[type]
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}"></i>
    <span>${message
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}</span>
  `;

  container.appendChild(toast);

  setTimeout(() => {
    toast.style.animation =
      "slideInRight 0.3s ease reverse";
    setTimeout(() => toast.remove(), 300);
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}, 3000);

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

// Close modal on backdrop click
document.addEventListener("click", (e) => {
  if (e.target.classList.contains("modal")) {
    e.target.classList.remove("active");
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});

// ESC to close modals
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") {
    document
      .querySelectorAll(".modal.active")
      .forEach((modal) =>
        modal.classList.remove("active")
      );
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});


// ========================================
// UI RENDERING (override with iCal export link)
// ========================================
function renderProperties() {
  const grid = document.getElementById("propertiesGrid");

  if (!properties.length) {
    grid.innerHTML = `
      <div class="empty-state">
        <i class="fas fa-home"></i>
        <p>Aucun logement configur√©</p>
        <p style="font-size: 14px; margin-top: 8px;">Cliquez sur "Ajouter un logement" pour commencer</p>
      </div>
    `;
    return;
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

  const baseApi = (typeof API_URL === "string" ? API_URL.replace(/\/$/, "") : "");

  grid.innerHTML = properties
    .map((property) => {
      const exportUrl = baseApi
        ? `${baseApi
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}/ical/property/${property.id
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}.ics`
        : `/ical/property/${property.id
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}.ics`;

      const icalSourcesHtml =
        property.icalUrls && property.icalUrls.length > 0
          ? `
        <div class="ical-urls">
          ${property.icalUrls
            .map(
              (urlData) => `
            <div class="ical-url-item">
              <i class="fas fa-link"></i>
              <span class="ical-source">${urlData.source || "URL"
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}</span>
              <span class="ical-url-text" title="${urlData.url
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}">${urlData.url
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}</span>
            </div>
          `
            )
            .join("")
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
        </div>
      `
          : `
        <div style="padding: 12px; background: var(--bg-secondary, #f3f4f6); border-radius: 12px; display:flex; align-items:center; gap:8px; font-size: 14px; color: var(--text-secondary);">
          <i class="fas fa-exclamation-triangle"></i>
          <span>Aucune URL iCal configur√©e</span>
        </div>
      `;

      return `
    <div class="property-card" style="border-left-color: ${property.color
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}">
      <div class="property-header">
        <div class="property-info">
          <div class="property-name">
            <div class="color-badge" style="background-color: ${property.color
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}"></div>
            ${property.name
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
          </div>
          <div class="property-meta">
            ${property.reservationCount || 0
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} r√©servation(s) ‚Ä¢ 
            ${(property.icalUrls && property.icalUrls.length) || 0
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} source(s) iCal import√©es
          </div>
        </div>
        <div class="property-actions">
          <button class="btn-icon-action btn-edit" 
                  onclick="openEditPropertyModal('${property.id
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}')"
                  title="Modifier">
            <i class="fas fa-edit"></i>
          </button>
          <button class="btn-icon-action btn-delete" 
                  onclick="deleteProperty('${property.id
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}', '${(property.name || "").replace(/'/g, "\'")
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}')"
                  title="Supprimer">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>

      <div class="property-ical-export">
        <div class="ical-export-label">
          <i class="fa-solid fa-calendar-days"></i>
          <span>Lien iCal Boostinghost pour ce logement</span>
        </div>
        <div class="ical-export-body">
          <span class="ical-export-url" title="${exportUrl
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}">${exportUrl
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}</span>
          <button class="btn-copy-ical" type="button" onclick="copyIcalExportUrl('${exportUrl
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}')">
            <i class="fa-regular fa-copy"></i>
            Copier
          </button>
        </div>
      </div>

      ${icalSourcesHtml
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
    </div>
  `;
    
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

})
    .join("");

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

// Copier le lien iCal export
function copyIcalExportUrl(url) {
  if (!url) return;

  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard
      .writeText(url)
      .then(() => {
        if (typeof showToast === "function") {
          showToast("Lien iCal copi√© dans le presse-papiers", "success");
        
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

})
      .catch(() => {
        window.prompt("Copiez ce lien iCal :", url);
      
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

});
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

} else {
    window.prompt("Copiez ce lien iCal :", url);
  
function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

function renderProperties() {
  console.log("Rendu des logements :", properties);
  const container = document.getElementById("propertiesContainer");
  if (!container) {
    console.error("Le conteneur propertiesContainer n'existe pas dans le HTML.");
    return;
  }
  container.innerHTML = properties.map(property => 
    `<div class="property">
      <h3>">${property.name}</h3>
      <p>Adresse : ">${property.address || "Non sp√©cifi√©e"}</p>
      <p>Couleur : <span style="color: ">${property.color}">">${property.color}</span></p>
      <p>Heure d'arriv√©e : ">${property.checkIn || "Non sp√©cifi√©e"}</p>
      <p>Heure de d√©part : ">${property.checkOut || "Non sp√©cifi√©e"}</p>
      <p>Caution : ">${property.deposit || "0"} ‚Ç¨</p>
    </div>`
  ).join("".);
}

}

