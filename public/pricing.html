    </div>

    <!-- Bannière offre de lancement -->
    <div class="launch-banner">
      <i class="fas fa-rocket"></i>
      Offre de lancement : Prix réduits pour les 200 premiers clients !
    </div>

    <!-- Toggle Mensuel/Annuel -->
    <div class="billing-toggle">
      <button class="active" onclick="showMonthly()">Mensuel</button>
      <button onclick="showAnnual()">Annuel <span style="background: #10b981; color: white; padding: 2px 8px; border-radius: 12px; margin-left: 8px; font-size: 12px;">-17%</span></button>
    </div>

    <!-- Plans -->
    <div class="pricing-plans">
      <!-- Plan Solo -->
      <div class="pricing-card">
        <div class="plan-badge">Idéal pour démarrer</div>
        <h2 class="plan-name">Solo</h2>
        <div class="plan-price">
          <span class="price-amount monthly-price">14,90€</span>
          <span class="price-amount annual-price" style="display:none;">149€</span>
          <span class="price-period monthly-period">/mois</span>
          <span class="price-period annual-period" style="display:none;">/an</span>
          <span class="price-annual annual-price" style="display:none;">soit 12,42€/mois (2 mois offerts)</span>
        </div>
        <p class="plan-description">
          <strong>1 à 3 logements</strong><br>
          Pour propriétaires et petites locations
        </p>

        <ul class="plan-features">
          <li><i class="fas fa-check"></i> Calendrier unifié (synchro iCal)</li>
          <li><i class="fas fa-check"></i> Messages automatiques IA</li>
          <li><i class="fas fa-check"></i> Serrures connectées Igloohome</li>
          <li><i class="fas fa-check"></i> Gestion des ménages</li>
          <li><i class="fas fa-check"></i> Facturation voyageurs & propriétaires</li>
          <li><i class="fas fa-check"></i> Cautions & décomptes</li>
          <li><i class="fas fa-check"></i> Livrets d'accueil</li>
          <li><i class="fas fa-check"></i> Support email</li>
        </ul>

        <button class="btn btn-ghost btn-large" onclick="startCheckout('solo')">
          Essayer gratuitement 14 jours
        </button>
      </div>

      <!-- Plan Pro (Featured) -->
      <div class="pricing-card featured">
        <div class="plan-badge">Le plus populaire</div>
        <h2 class="plan-name">Pro</h2>
        <div class="plan-price">
          <span class="price-amount monthly-price">49€</span>
          <span class="price-amount annual-price" style="display:none;">490€</span>
          <span class="price-period monthly-period">/mois</span>
          <span class="price-period annual-period" style="display:none;">/an</span>
          <span class="price-annual annual-price" style="display:none;">soit 40,83€/mois (2 mois offerts)</span>
        </div>
        <p class="plan-description">
          <strong>4 à 15 logements</strong><br>
          Pour conciergeries et gestionnaires
        </p>

        <ul class="plan-features">
          <li><i class="fas fa-check"></i> <strong>Tout du plan Solo</strong></li>
          <li><i class="fas fa-check"></i> Support prioritaire (email + chat)</li>
          <li><i class="fas fa-check"></i> Statistiques avancées</li>
          <li><i class="fas fa-check"></i> Export des données</li>
          <li><i class="fas fa-check"></i> Multi-propriétaires</li>
          <li><i class="fas fa-check"></i> Rapports personnalisés</li>
        </ul>

        <button class="btn btn-primary btn-large" onclick="startCheckout('pro')">
          Essayer gratuitement 14 jours
        </button>
      </div>

      <!-- Plan Business -->
      <div class="pricing-card">
        <div class="plan-badge">Pour les pros</div>
        <h2 class="plan-name">Business</h2>
        <div class="plan-price">
          <span class="price-amount monthly-price">99€</span>
          <span class="price-amount annual-price" style="display:none;">990€</span>
          <span class="price-period monthly-period">/mois</span>
          <span class="price-period annual-period" style="display:none;">/an</span>
          <span class="price-annual annual-price" style="display:none;">soit 82,50€/mois (2 mois offerts)</span>
        </div>
        <p class="plan-description">
          <strong>16 à 50 logements</strong><br>
          Pour grosses conciergeries
        </p>

        <ul class="plan-features">
          <li><i class="fas fa-check"></i> <strong>Tout du plan Pro</strong></li>
          <li><i class="fas fa-check"></i> Support téléphone</li>
          <li><i class="fas fa-check"></i> Onboarding personnalisé</li>
          <li><i class="fas fa-check"></i> Account manager dédié</li>
          <li><i class="fas fa-check"></i> API personnalisée</li>
          <li><i class="fas fa-check"></i> Intégrations sur mesure</li>
        </ul>

        <button class="btn btn-ghost btn-large" onclick="startCheckout('business')">
          Essayer gratuitement 14 jours
        </button>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="pricing-faq">
      <h3>Questions fréquentes</h3>
      <div class="faq-grid">
        <div class="faq-item">
          <div class="faq-icon"><i class="fas fa-question-circle"></i></div>
          <div>
            <h4>Comment fonctionne l'essai gratuit ?</h4>
            <p>Vous bénéficiez de 14 jours d'accès complet sans aucune carte bancaire requise. Vous pourrez ensuite choisir de continuer avec un abonnement.</p>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-icon"><i class="fas fa-home"></i></div>
          <div>
            <h4>Que se passe-t-il si j'ai plus de logements ?</h4>
            <p>Vous pouvez changer de plan à tout moment. Par exemple, si vous passez de 3 à 5 logements, il suffit de passer au plan Pro.</p>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-icon"><i class="fas fa-sync-alt"></i></div>
          <div>
            <h4>Puis-je changer de plan ?</h4>
            <p>Oui, vous pouvez changer de plan à tout moment. Le changement prend effet immédiatement et le montant est proratisé.</p>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-icon"><i class="fas fa-times-circle"></i></div>
          <div>
            <h4>Puis-je annuler mon abonnement ?</h4>
            <p>Oui, sans engagement. Vous pouvez annuler à tout moment depuis vos paramètres. Vous conservez l'accès jusqu'à la fin de la période payée.</p>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-icon"><i class="fas fa-building"></i></div>
          <div>
            <h4>Y a-t-il une différence entre propriétaire et conciergerie ?</h4>
            <p>Non ! Tous les plans incluent à la fois les fonctionnalités pour propriétaires et conciergeries. Choisissez simplement selon votre nombre de logements.</p>
          </div>
        </div>

        <div class="faq-item">
          <div class="faq-icon"><i class="fas fa-percent"></i></div>
          <div>
            <h4>Y a-t-il des frais supplémentaires ?</h4>
            <p>Non ! Tous les prix sont TTC, aucun frais caché. Les seuls frais additionnels sont ceux de Stripe pour les paiements de cautions (1,4% + 0,25€) et Igloohome pour les serrures (2$/serrure/mois).</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <div class="pricing-footer">
      <p>Déjà un compte ? <a href="/login.html">Se connecter</a></p>
    </div>
  </div>

  <script>
  // Toggle Mensuel / Annuel
  function showMonthly() {
    document.querySelectorAll('.monthly-price, .monthly-period').forEach(el => el.style.display = '');
    document.querySelectorAll('.annual-price, .annual-period').forEach(el => el.style.display = 'none');
    document.querySelectorAll('.billing-toggle button')[0].classList.add('active');
    document.querySelectorAll('.billing-toggle button')[1].classList.remove('active');
  }

  function showAnnual() {
    document.querySelectorAll('.monthly-price, .monthly-period').forEach(el => el.style.display = 'none');
    document.querySelectorAll('.annual-price, .annual-period').forEach(el => el.style.display = '');
    document.querySelectorAll('.billing-toggle button')[0].classList.remove('active');
    document.querySelectorAll('.billing-toggle button')[1].classList.add('active');
  }

  // Démarrer le checkout
  async function startCheckout(plan) {
    const token = localStorage.getItem('lcc_token');

    if (!token) {
      alert('Veuillez vous connecter pour souscrire à un abonnement.');
      window.location.href = '/login.html';
      return;
    }

    try {
      const button = event.target;
      button.disabled = true;
      button.textContent = 'Redirection vers Stripe...';

      // Déterminer si mensuel ou annuel
      const isAnnual = document.querySelectorAll('.billing-toggle button')[1].classList.contains('active');
      const billingPlan = isAnnual ? plan + '_annual' : plan + '_monthly';

      const res = await fetch('/api/billing/create-checkout-session', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer ' + token
        },
        body: JSON.stringify({ plan: billingPlan })
      });

      if (!res.ok) {
        throw new Error('Erreur lors de la création de la session');
      }

      const data = await res.json();

      if (data.url) {
        window.location.href = data.url;
      } else {
        throw new Error('URL de paiement non reçue');
      }

    } catch (err) {
      console.error('Erreur checkout:', err);
      alert('Impossible de démarrer le paiement. Réessayez plus tard.');
      
      const button = event.target;
      button.disabled = false;
      button.textContent = 'Essayer gratuitement 14 jours';
    }
  }

  // Adapter les boutons selon le statut
  async function checkUserStatus() {
    const token = localStorage.getItem('lcc_token');
    if (!token) return;

    try {
      const res = await fetch('/api/subscription/status', {
        headers: { 'Authorization': 'Bearer ' + token }
      });

      if (res.ok) {
        const data = await res.json();
        
        if (data.status === 'expired' || data.status === 'canceled' || 
            (data.status === 'trial' && data.daysRemaining < 0)) {
          
          document.querySelectorAll('button[onclick*="startCheckout"]').forEach(btn => {
            btn.textContent = 'S\'abonner maintenant';
          });
        }
      }
    } catch (err) {
      console.error('Erreur:', err);
    }
  }

  document.addEventListener('DOMContentLoaded', checkUserStatus);
</script>
</body>
</html>
