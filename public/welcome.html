<!DOCTYPE html>
<html lang="fr" data-theme="light" data-theme-v3="1">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<title>Livret d'accueil ‚Äì Boostinghost</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"/>
<script src="/js/auth-fetch.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<link href="/css/style.css" rel="stylesheet"/>
<link href="/css/bh-shared.css?v=1" rel="stylesheet"/>
<link href="/css/bh-theme-v3.css" rel="stylesheet"/>
<link href="/css/bottom-bar-enhanced.css" rel="stylesheet"/>
<link href="/css/messages-badge-fix.css" rel="stylesheet"/>
<link rel="stylesheet" href="/css/messages-badge-red.css">
<link rel="stylesheet" href="/css/mobile-native-styles.css">
<style>
/* ============================================================
   DARK BAR + STICKY HEADER (identical to app.html)
   ============================================================ */
html[data-theme-v3="1"] body { padding-top: 40px !important; }
html[data-theme-v3="1"] .sidebar {
  position: fixed !important; top: 40px !important;
  left: 0 !important; bottom: 0 !important;
  height: auto !important;
  z-index: 30 !important;
}
html[data-theme-v3="1"] header.main-header {
  position: sticky !important;
  top: 0 !important;
  z-index: 50 !important;
  margin-top: 0 !important;
}
html[data-theme-v3="1"] main.main-content {
  padding-top: 0 !important;
  margin-top: 0 !important;
  position: relative !important;
  z-index: 35 !important;
}
html[data-theme-v3="1"] .app-container {
  margin-top: 0 !important;
  padding-top: 0 !important;
}
/* Tuer tout espace parasite entre barre dark et header */
html[data-theme-v3="1"] main.main-content > header.main-header {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* ‚îÄ‚îÄ BARRE DARK EN HAUT ‚îÄ‚îÄ */
html[data-theme-v3="1"] .bh-demo-nav {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 9999;
  background: #0D1117;
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 0 16px;
  height: 40px;
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  /* Pour le centrage absolu des badges */
  position: fixed;
}
html[data-theme-v3="1"] .bh-demo-nav .bh-demo-label {
  color: rgba(255,255,255,.4);
  font-weight: 500;
  margin-right: 6px;
  letter-spacing: .08em;
  text-transform: uppercase;
  font-size: 11px;
  white-space: nowrap;
}
html[data-theme-v3="1"] .bh-demo-nav a.bh-demo-btn,
html[data-theme-v3="1"] .bh-demo-nav .bh-demo-btn {
  padding: 4px 13px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.15);
  background: transparent;
  color: rgba(255,255,255,.6);
  cursor: pointer;
  font-family: 'DM Sans', sans-serif;
  font-size: 11.5px;
  font-weight: 500;
  transition: all .2s;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  text-decoration: none;
  white-space: nowrap;
}
html[data-theme-v3="1"] .bh-demo-nav a.bh-demo-btn:hover,
html[data-theme-v3="1"] .bh-demo-nav .bh-demo-btn:hover {
  background: rgba(255,255,255,.1);
  color: white;
}
html[data-theme-v3="1"] .bh-demo-nav a.bh-demo-btn.active,
html[data-theme-v3="1"] .bh-demo-nav .bh-demo-btn.active {
  background: #1A7A5E;
  color: white;
  border-color: #1A7A5E;
}
html[data-theme-v3="1"] .bh-demo-nav .bh-demo-right {
  margin-left: auto;
  display: flex;
  align-items: center;
  gap: 10px;
  flex-shrink: 0;
}
html[data-theme-v3="1"] .bh-demo-nav .bh-demo-mode-label {
  color: rgba(255,255,255,.4);
  font-size: 10.5px;
  font-weight: 500;
  letter-spacing: .07em;
  text-transform: uppercase;
}
html[data-theme-v3="1"] .bh-theme-toggle {
  width: 44px;
  height: 24px;
  background: rgba(255,255,255,.15);
  border-radius: 999px;
  border: none;
  cursor: pointer;
  position: relative;
  transition: background .2s;
  flex-shrink: 0;
}
html[data-theme-v3="1"] .bh-theme-toggle::after {
  content: '';
  position: absolute;
  top: 3px; left: 3px;
  width: 18px; height: 18px;
  background: white;
  border-radius: 50%;
  transition: transform .2s;
}
html[data-theme-v3="1"][data-theme="dark"] .bh-theme-toggle { background: #1A7A5E; }
html[data-theme-v3="1"][data-theme="dark"] .bh-theme-toggle::after { transform: translateX(20px); }


/* ============================================================
   PAGE WELCOME ‚Äî V3
   ============================================================ */
html[data-theme-v3="1"],
html[data-theme-v3="1"] body {
  overflow: hidden !important;
  height: 100% !important;
}
html[data-theme-v3="1"] .app-container {
  height: calc(100vh - 40px) !important;
  overflow: hidden !important;
}
html[data-theme-v3="1"] .main-content {
  background: #F5F2EC !important;
  overflow-y: auto !important;
  height: 100% !important;
}
html[data-theme-v3="1"] .sidebar { z-index: 30 !important; }
html[data-theme-v3="1"] main.main-content {
  padding-top: 0 !important;
  margin-top: 0 !important;
  position: relative !important;
  z-index: 35 !important;
}
html[data-theme-v3="1"] .header-actions .btn-ghost,
html[data-theme-v3="1"] .header-actions .btn.btn-ghost { display: none !important; }

/* Back button */
.welcome-back-btn {
  display: inline-flex; align-items: center; gap: 8px;
  height: 40px; padding: 0 20px; border: none; border-radius: 12px;
  background: #1A7A5E; color: white; font-family: 'DM Sans', sans-serif;
  font-size: 14px; font-weight: 600; cursor: pointer; transition: background .15s;
  white-space: nowrap; position: fixed; top: calc(40px + 13px); right: 24px; z-index: 200;
}
.welcome-back-btn:hover { background: #15624B; }

/* Page container */
.welcome-container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 28px 24px 60px;
}

/* ‚îÄ‚îÄ Section header ‚îÄ‚îÄ */
.welcome-section-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 28px;
}
.welcome-kicker {
  font-size: 11px; font-weight: 600; letter-spacing: .1em;
  text-transform: uppercase; color: rgba(13,17,23,.38); margin-bottom: 4px;
}
.welcome-title {
  font-family: 'Instrument Serif', serif;
  font-size: 28px; font-weight: 400; color: #0D1117; margin: 0;
}
.welcome-title em { font-style: italic; color: #1A7A5E; }

/* ‚îÄ‚îÄ Livrets list ‚îÄ‚îÄ */
.livrets-grid {
  display: grid !important;
  grid-template-columns: repeat(3, 1fr) !important;
  gap: 20px;
  margin-bottom: 24px;
}
@media(max-width:1000px){ .livrets-grid { grid-template-columns: repeat(2,1fr) !important; } }
@media(max-width:600px){ .livrets-grid { grid-template-columns: 1fr !important; } }
.livret-card {
  background: #F5F0E8;
  border: 1px solid rgba(200,184,154,.4);
  border-radius: 20px;
  overflow: hidden;
  display: flex; flex-direction: column;
  transition: all .2s cubic-bezier(0.16,1,0.3,1);
}
.livret-card:hover { transform: translateY(-3px); box-shadow: 0 12px 40px rgba(13,17,23,.12); border-color: #C8B89A; }
.livret-card-hero {
  height: 160px;
  background: linear-gradient(135deg, #1A7A5E 0%, #2AAE86 60%, #C8B89A 100%);
  position: relative;
  display: flex; align-items: center; justify-content: center;
}
.livret-card-hero-icon { font-size: 56px; opacity: .9; }
.livret-card-body { padding: 16px; flex: 1; display: flex; flex-direction: column; gap: 10px; }
.livret-card-icon {
  width: 44px; height: 44px; border-radius: 12px;
  background: rgba(26,122,94,.1); display: flex; align-items: center;
  justify-content: center; font-size: 20px; color: #1A7A5E;
}
.livret-card-name {
  font-size: 15px; font-weight: 700; color: #0D1117;
  font-family: 'DM Sans', sans-serif; margin-bottom: 3px;
}
.livret-card-date { font-size: 12px; color: #7A8695; }
.livret-card-actions {
  display: flex; gap: 8px;
  padding-top: 12px;
  border-top: 1px solid rgba(13,17,23,.08);
}
.livret-card-actions .btn-lv {
  flex: 1; height: 34px; border-radius: 9px; font-size: 12.5px;
  font-weight: 600; cursor: pointer; transition: all .15s; border: none;
  display: flex; align-items: center; justify-content: center; gap: 5px;
  font-family: 'DM Sans', sans-serif;
}
.btn-lv-edit { background: white; color: #0D1117; border: 1px solid rgba(0,0,0,.12) !important; }
.btn-lv-edit:hover { background: #f0ede7; }
.btn-lv-view { background: #1A7A5E; color: white; }
.btn-lv-view:hover { background: #15624B; }
.btn-lv-delete {
  flex: 0 0 34px !important; width: 34px;
  background: #FEF2F2; color: #DC2626;
  border: 1px solid rgba(220,38,38,.15) !important;
}
.btn-lv-delete:hover { background: #FEE2E2; }

/* Dashed add card */
.livret-card-add {
  background: transparent;
  border: 2px dashed rgba(26,122,94,.3);
  border-radius: 20px; padding: 28px;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center; gap: 12px;
  cursor: pointer; transition: all .2s; text-align: center;
  min-height: 240px;
}
.livret-card-add:hover { border-color: #1A7A5E; background: rgba(26,122,94,.04); }
.livret-card-add-icon {
  width: 44px; height: 44px; border-radius: 12px;
  background: rgba(26,122,94,.1); display: flex; align-items: center;
  justify-content: center; font-size: 20px; color: #1A7A5E;
}
.livret-card-add-label { font-size: 14px; font-weight: 700; color: #0D1117; }
.livret-card-add-sub { font-size: 12px; color: #7A8695; }

/* ‚îÄ‚îÄ Wizard stepper ‚îÄ‚îÄ */
.wizard-stepper {
  display: flex; align-items: center;
  background: white; border-radius: 16px;
  border: 1px solid rgba(200,184,154,.4);
  padding: 16px 20px; margin-bottom: 24px;
  gap: 4px; overflow-x: auto;
}
.wizard-step {
  display: flex; align-items: center; gap: 8px;
  padding: 8px 14px; border-radius: 10px; cursor: pointer;
  transition: all .15s; white-space: nowrap; flex: 1;
  justify-content: center;
}
.wizard-step-num {
  width: 26px; height: 26px; border-radius: 50%;
  background: rgba(13,17,23,.08); color: #7A8695;
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 700; flex-shrink: 0;
}
.wizard-step-label { font-size: 12.5px; font-weight: 600; color: #7A8695; }
.wizard-step.active { background: rgba(26,122,94,.08); }
.wizard-step.active .wizard-step-num { background: #1A7A5E; color: white; }
.wizard-step.active .wizard-step-label { color: #1A7A5E; }
.wizard-step.done .wizard-step-num { background: rgba(26,122,94,.15); color: #1A7A5E; }
.wizard-step.done .wizard-step-label { color: #0D1117; }
.wizard-sep { width: 24px; height: 2px; background: rgba(13,17,23,.08); flex-shrink: 0; }

/* ‚îÄ‚îÄ Form card ‚îÄ‚îÄ */
.wiz-card {
  background: white; border: 1px solid rgba(200,184,154,.35);
  border-radius: 16px; overflow: hidden; margin-bottom: 16px;
}
.wiz-card-header {
  padding: 20px 24px; border-bottom: 1px solid rgba(13,17,23,.06);
  background: #FAFAF8; display: flex; align-items: center; gap: 12px;
}
.wiz-card-icon {
  width: 40px; height: 40px; border-radius: 10px;
  background: rgba(26,122,94,.1); display: flex; align-items: center;
  justify-content: center; color: #1A7A5E; font-size: 16px; flex-shrink: 0;
}
.wiz-card-title { font-size: 16px; font-weight: 700; color: #0D1117; margin: 0; }
.wiz-card-sub { font-size: 13px; color: #7A8695; margin: 2px 0 0; }
.wiz-card-body { padding: 24px; }

/* ‚îÄ‚îÄ Form elements ‚îÄ‚îÄ */
.wiz-group { margin-bottom: 20px; }
.wiz-group:last-child { margin-bottom: 0; }
.wiz-label {
  display: block; font-size: 13px; font-weight: 600;
  color: #374151; margin-bottom: 6px;
}
.wiz-hint { font-size: 12px; color: #9CA3AF; font-weight: 400; display: block; margin-top: 2px; }
.wiz-required { color: #EF4444; }
.wiz-input, .wiz-textarea, .wiz-select {
  width: 100%; padding: 10px 14px;
  background: #FAFAF8; border: 1.5px solid rgba(13,17,23,.12);
  border-radius: 10px; font-size: 14px; font-family: 'DM Sans', sans-serif;
  color: #0D1117; transition: border-color .15s;
  outline: none;
}
.wiz-input:focus, .wiz-textarea:focus, .wiz-select:focus {
  border-color: #1A7A5E; background: white;
  box-shadow: 0 0 0 3px rgba(26,122,94,.08);
}
.wiz-textarea { resize: vertical; min-height: 90px; }
.wiz-grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
@media(max-width:640px){ .wiz-grid-2 { grid-template-columns: 1fr; } }

/* Sub-sections inside card */
.wiz-subsection { margin-bottom: 24px; }
.wiz-subsection:last-child { margin-bottom: 0; }
.wiz-subsection-title {
  font-size: 13px; font-weight: 700; text-transform: uppercase;
  letter-spacing: .06em; color: #7A8695; margin-bottom: 14px;
  display: flex; align-items: center; gap: 8px;
}
.wiz-subsection-title i { color: #1A7A5E; }
.wiz-divider { border: none; border-top: 1px solid rgba(13,17,23,.07); margin: 24px 0; }

/* Image upload */
.wiz-upload {
  border: 2px dashed rgba(13,17,23,.12); border-radius: 12px;
  padding: 24px; text-align: center; cursor: pointer;
  background: #FAFAF8; transition: all .15s;
}
.wiz-upload:hover { border-color: #1A7A5E; background: rgba(26,122,94,.03); }
.wiz-upload i { font-size: 28px; color: #9CA3AF; margin-bottom: 8px; display: block; }
.wiz-upload p { font-size: 13px; color: #9CA3AF; margin: 4px 0; }
.wiz-upload-hint { font-size: 11px; color: #C4C4C4; }
.image-preview { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; }
.image-preview-item img, .preview-thumb img {
  width: 72px; height: 72px; object-fit: cover;
  border-radius: 8px; border: 1px solid rgba(0,0,0,.08);
}

/* Repeat blocks */
.wiz-repeat-block {
  background: #FAFAF8; border: 1px solid rgba(13,17,23,.08);
  border-radius: 12px; padding: 16px; margin-bottom: 12px; position: relative;
}
.wiz-repeat-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 14px;
}
.wiz-repeat-title { font-size: 13px; font-weight: 700; color: #374151; }
.wiz-remove-btn {
  width: 28px; height: 28px; border-radius: 8px; border: none;
  background: #FEF2F2; color: #DC2626; cursor: pointer; font-size: 12px;
  display: flex; align-items: center; justify-content: center;
}
.wiz-remove-btn:hover { background: #FEE2E2; }
.wiz-add-btn {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 10px 16px; border-radius: 10px;
  background: rgba(26,122,94,.08); color: #1A7A5E;
  border: 1px dashed rgba(26,122,94,.3); cursor: pointer;
  font-size: 13px; font-weight: 600; font-family: 'DM Sans', sans-serif;
  transition: all .15s; width: 100%; justify-content: center; margin-top: 4px;
}
.wiz-add-btn:hover { background: rgba(26,122,94,.14); border-color: #1A7A5E; }

/* Wizard nav buttons */
.wiz-nav {
  display: flex; align-items: center; justify-content: space-between;
  padding: 20px 0 8px;
}
.wiz-btn-back {
  display: inline-flex; align-items: center; gap: 8px; height: 42px;
  padding: 0 20px; border: 1.5px solid rgba(13,17,23,.15); border-radius: 12px;
  background: white; color: #374151; font-family: 'DM Sans', sans-serif;
  font-size: 14px; font-weight: 600; cursor: pointer; transition: all .15s;
}
.wiz-btn-back:hover { border-color: rgba(13,17,23,.3); }
.wiz-btn-next {
  display: inline-flex; align-items: center; gap: 8px; height: 42px;
  padding: 0 24px; border: none; border-radius: 12px;
  background: #1A7A5E; color: white; font-family: 'DM Sans', sans-serif;
  font-size: 14px; font-weight: 600; cursor: pointer; transition: background .15s;
}
.wiz-btn-next:hover { background: #15624B; }
.wiz-btn-submit {
  display: inline-flex; align-items: center; gap: 8px; height: 42px;
  padding: 0 24px; border: none; border-radius: 12px;
  background: #0D1117; color: white; font-family: 'DM Sans', sans-serif;
  font-size: 14px; font-weight: 600; cursor: pointer; transition: background .15s;
}
.wiz-btn-submit:hover { background: #1C2333; }

/* Success message */
.wiz-success {
  text-align: center; padding: 48px 24px;
  background: white; border-radius: 16px;
  border: 1px solid rgba(200,184,154,.35);
}
.wiz-success-icon {
  width: 72px; height: 72px; border-radius: 50%;
  background: rgba(26,122,94,.1); color: #1A7A5E;
  display: flex; align-items: center; justify-content: center;
  font-size: 28px; margin: 0 auto 20px;
}
.wiz-success h2 { font-family: 'Instrument Serif', serif; font-size: 26px; font-weight: 400; margin-bottom: 8px; }
.wiz-success p { color: #7A8695; font-size: 14px; margin-bottom: 24px; }
.wiz-success-actions { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-top: 24px; }
.wiz-qr-box {
  background: #FAFAF8; border: 1px solid rgba(13,17,23,.08);
  border-radius: 14px; padding: 24px; max-width: 340px; margin: 24px auto 0;
}
.wiz-qr-box h3 { font-size: 15px; font-weight: 600; margin-bottom: 16px; color: #0D1117; }

/* Info/warning boxes */
.wiz-info-box {
  background: rgba(26,122,94,.06); border: 1px solid rgba(26,122,94,.2);
  border-radius: 10px; padding: 12px 16px; font-size: 13px;
  color: #1A7A5E; margin-bottom: 20px; display: flex; gap: 10px; align-items: flex-start;
}
.wiz-warn-box {
  background: rgba(245,158,11,.06); border: 1px solid rgba(245,158,11,.2);
  border-radius: 10px; padding: 12px 16px; font-size: 13px;
  color: #92400E; margin-bottom: 20px; display: flex; gap: 10px; align-items: flex-start;
}


.livret-card-stats {
  display: grid; grid-template-columns: repeat(3, 1fr);
  gap: 8px; padding: 10px 0;
  border-top: 1px solid rgba(13,17,23,.08);
  margin-top: 4px;
}
.livret-stat { text-align: center; }
.livret-stat-val { font-size: 15px; font-weight: 700; color: #0D1117; }
.livret-stat-label { font-size: 10px; color: #7A8695; text-transform: uppercase; letter-spacing: .06em; margin-top: 2px; }


/* ‚îÄ‚îÄ Tip banner ‚îÄ‚îÄ */
.welcome-tip-banner {
  background: linear-gradient(135deg, #0D1117 0%, #1A3A2E 100%);
  border-radius: 20px;
  padding: 28px 32px;
  margin-bottom: 28px;
  display: flex; align-items: center; justify-content: space-between; gap: 24px;
  position: relative; overflow: hidden;
}
.welcome-tip-banner::before {
  content: 'üìñ';
  position: absolute; right: 24px; top: 50%; transform: translateY(-50%);
  font-size: 80px; opacity: .08;
}
.welcome-tip-title {
  font-family: 'Instrument Serif', serif;
  font-size: 22px; font-weight: 400; color: white; margin-bottom: 6px;
}
.welcome-tip-title em { font-style: italic; color: #4ADE80; }
.welcome-tip-sub { font-size: 13px; color: rgba(255,255,255,.55); line-height: 1.5; max-width: 500px; }
.welcome-tip-badges { display: flex; gap: 8px; margin-top: 14px; flex-wrap: wrap; }
.welcome-tip-badge {
  display: inline-flex; align-items: center; gap: 6px;
  background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.12);
  color: rgba(255,255,255,.7); font-size: 12px; font-weight: 500;
  padding: 5px 12px; border-radius: 999px;
}
.welcome-tip-badge i { color: #4ADE80; font-size: 11px; }
.welcome-tip-cta {
  flex-shrink: 0;
  display: inline-flex; align-items: center; gap: 8px;
  height: 42px; padding: 0 22px; border: none; border-radius: 12px;
  background: #1A7A5E; color: white; font-family: 'DM Sans', sans-serif;
  font-size: 14px; font-weight: 600; cursor: pointer; transition: background .15s;
  white-space: nowrap;
}
.welcome-tip-cta:hover { background: #15624B; }

/* QR button on card */
.btn-lv-qr {
  flex: 0 0 34px !important; width: 34px;
  background: rgba(26,122,94,.1); color: #1A7A5E;
  border: 1px solid rgba(26,122,94,.2) !important;
}
.btn-lv-qr:hover { background: rgba(26,122,94,.2); }

/* Hidden form section */
.form-section { display: none; }
.form-section.active { display: block; }

/* Hide redundant page title ‚Äî banner replaces it */
html[data-theme-v3="1"] #bhHeader .page-title,
html[data-theme-v3="1"] #bhHeader .bh-page-title,
html[data-theme-v3="1"] #bhHeader h1,
html[data-theme-v3="1"] #bhHeader .header-title,
html[data-theme-v3="1"] #bhHeader .page-header-title {
  display: none !important;
}

/* Hide bh-layout injected page title for welcome page */
.main-content > .page-title:not(#bhHeader),
.main-content .bh-page-header,
.container > .page-title {
  display: none !important;
}
</style>
</head>
<body data-back-href="/app.html" data-page="welcome">

<!-- Dark bar -->
<div class="bh-demo-nav" id="bhTopBar">
  <!-- Connexions centr√©es -->
  <div style="position:absolute;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:16px;">

    <!-- Airbnb -->
    <div style="display:flex;align-items:center;gap:7px;">
      <i class="fa-brands fa-airbnb" style="font-size:15px;color:#FF5A5F;"></i>
      <span style="color:rgba(255,255,255,.7);font-size:12px;font-weight:500;">Airbnb</span>
      <span id="topbar-status-airbnb" style="font-size:11px;font-weight:600;padding:2px 9px;border-radius:999px;background:rgba(239,68,68,.2);color:#F87171;border:1px solid rgba(239,68,68,.35);">
        <i class="fas fa-circle" style="font-size:7px;margin-right:3px;vertical-align:middle;"></i>Non connect√©
      </span>
    </div>

    <div style="width:1px;height:16px;background:rgba(255,255,255,.1);"></div>

    <!-- Booking.com -->
    <div style="display:flex;align-items:center;gap:7px;">
      <span style="font-size:13px;font-weight:800;color:#003580;">B.</span>
      <span style="color:rgba(255,255,255,.7);font-size:12px;font-weight:500;">Booking.com</span>
      <span id="topbar-status-booking" style="font-size:11px;font-weight:600;padding:2px 9px;border-radius:999px;background:rgba(239,68,68,.2);color:#F87171;border:1px solid rgba(239,68,68,.35);">
        <i class="fas fa-circle" style="font-size:7px;margin-right:3px;vertical-align:middle;"></i>Non connect√©
      </span>
    </div>

    <div style="width:1px;height:16px;background:rgba(255,255,255,.1);"></div>

    <!-- Stripe -->
    <div style="display:flex;align-items:center;gap:7px;">
      <i class="fa-brands fa-stripe-s" style="font-size:17px;color:#6772E5;"></i>
      <span style="color:rgba(255,255,255,.7);font-size:12px;font-weight:500;">Stripe</span>
      <span id="topbar-status-stripe" style="font-size:11px;font-weight:600;padding:2px 9px;border-radius:999px;background:rgba(239,68,68,.2);color:#F87171;border:1px solid rgba(239,68,68,.35);">
        <i class="fas fa-circle" style="font-size:7px;margin-right:3px;vertical-align:middle;"></i>Non connect√©
      </span>
    </div>

  </div>

  <!-- Toggle dark mode (droite) -->
  <div class="bh-demo-right">
    <span class="bh-demo-mode-label">Mode</span>
    <button class="bh-theme-toggle" id="bhThemeToggleDark" onclick="document.documentElement.getAttribute('data-theme')==='dark'?document.documentElement.setAttribute('data-theme','light'):document.documentElement.setAttribute('data-theme','dark')"></button>
  </div>
</div>

<script>
// Mise √† jour des statuts de connexion dans la top bar
(function updateTopBarStatus() {
  function setStatus(id, connected) {
    const el = document.getElementById(id);
    if (!el) return;
    if (connected) {
      el.style.background = 'rgba(34,197,94,.2)';
      el.style.color = '#4ADE80';
      el.style.borderColor = 'rgba(34,197,94,.35)';
      el.innerHTML = '<i class="fas fa-circle" style="font-size:7px;margin-right:3px;vertical-align:middle;"></i>Connect√©';
    } else {
      el.style.background = 'rgba(239,68,68,.2)';
      el.style.color = '#F87171';
      el.style.borderColor = 'rgba(239,68,68,.35)';
      el.innerHTML = '<i class="fas fa-circle" style="font-size:7px;margin-right:3px;vertical-align:middle;"></i>Non connect√©';
    }
  }

  function checkStatuses() {
    try {
      const reservations = JSON.parse(localStorage.getItem('LCC_RESERVATIONS') || '[]');
      const hasAirbnb = reservations.some(r =>
        (r.source || r.platform || '').toLowerCase().includes('airbnb')
      );
      const hasBooking = reservations.some(r =>
        (r.source || r.platform || '').toLowerCase().includes('booking')
      );
      setStatus('topbar-status-airbnb', hasAirbnb);
      setStatus('topbar-status-booking', hasBooking);

      // Stripe : v√©rifie lcc_user ou LCC_PROPERTIES
      const user = JSON.parse(localStorage.getItem('lcc_user') || '{}');
      const properties = JSON.parse(localStorage.getItem('LCC_PROPERTIES') || '[]');
      const hasStripe = !!(
        user.stripeAccountId ||
        user.stripe_account_id ||
        user.stripeConnected ||
        properties.some(p => p.stripeAccountId || p.stripe_account_id)
      );
      setStatus('topbar-status-stripe', hasStripe);
    } catch(e) {
      console.warn('TopBar status error:', e);
    }
  }

  // V√©rifier au chargement
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', checkStatuses);
  } else {
    checkStatuses();
  }

  // Re-v√©rifier apr√®s chargement des donn√©es API (d√©lai)
  setTimeout(checkStatuses, 2000);
  setTimeout(checkStatuses, 5000);

  // Exposer pour appel manuel apr√®s loadData
  window.updateTopBarStatus = checkStatuses;
})();
</script>

<div class="mobile-header">
  <a class="mobile-logo" href="/app.html"><i class="fas fa-calendar-check"></i><span class="mobile-logo-text">Boostinghost</span></a>
  <button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button>
</div>
<div class="sidebar-overlay" id="sidebarOverlay"></div>
<div class="app-container">
<div id="bhSidebar"></div>
<main class="main-content">
<div id="bhHeader"></div>
<button class="welcome-back-btn" onclick="window.location.href='/app.html'"><i class="fas fa-arrow-left"></i> Tableau de bord</button>

<div class="welcome-container">



  <!-- ‚îÄ‚îÄ Tip banner ‚îÄ‚îÄ -->
  <div class="welcome-tip-banner" id="welcomeTipBanner">
    <div>
      <div class="welcome-tip-title">Partagez un <em>livret num√©rique</em> √† vos voyageurs</div>
      <div class="welcome-tip-sub">Cr√©ez un livret d'accueil complet en 5 √©tapes. Vos voyageurs y acc√®dent via un lien ou un QR Code, sans application √† installer.</div>
      <div class="welcome-tip-badges">
        <span class="welcome-tip-badge"><i class="fas fa-check"></i> Lien personnalis√©</span>
        <span class="welcome-tip-badge"><i class="fas fa-check"></i> QR Code inclus</span>
        <span class="welcome-tip-badge"><i class="fas fa-check"></i> Toujours √† jour</span>
        <span class="welcome-tip-badge"><i class="fas fa-check"></i> Sans application</span>
      </div>
    </div>
    <button class="welcome-tip-cta" onclick="createNewLivret()">
      <i class="fas fa-plus"></i> Cr√©er un livret
    </button>
  </div>

  <!-- ‚îÄ‚îÄ Liste des livrets ‚îÄ‚îÄ -->
  <div id="livretsListSection">
    <div class="livrets-grid" id="livretsList">
      <p style="color:#7A8695;grid-column:1/-1;text-align:center;padding:24px">Chargement...</p>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ Wizard de cr√©ation ‚îÄ‚îÄ -->
  <form id="welcomeForm" style="display:none;">

    <!-- Progress bar -->
    <div style="margin-bottom:12px;">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;">
        <span id="wizProgressLabel" style="font-size:12px;font-weight:600;color:#1A7A5E;">√âtape 1 / 5</span>
        <span id="wizProgressPct" style="font-size:12px;color:#9CA3AF;">0%</span>
      </div>
      <div style="height:6px;background:rgba(13,17,23,.08);border-radius:999px;overflow:hidden;">
        <div id="wizProgressBar" style="height:100%;width:0%;background:linear-gradient(90deg,#1A7A5E,#2AAE86);border-radius:999px;transition:width .4s cubic-bezier(0.16,1,0.3,1);"></div>
      </div>
    </div>
    <!-- Stepper -->
    <div class="wizard-stepper" id="wizardStepper">
      <div class="wizard-step active" data-step="1">
        <div class="wizard-step-num">1</div>
        <div class="wizard-step-label">Infos g√©n√©rales</div>
      </div>
      <div class="wizard-sep"></div>
      <div class="wizard-step" data-step="2">
        <div class="wizard-step-num">2</div>
        <div class="wizard-step-label">Acc√®s & Arriv√©e</div>
      </div>
      <div class="wizard-sep"></div>
      <div class="wizard-step" data-step="3">
        <div class="wizard-step-num">3</div>
        <div class="wizard-step-label">Le logement</div>
      </div>
      <div class="wizard-sep"></div>
      <div class="wizard-step" data-step="4">
        <div class="wizard-step-num">4</div>
        <div class="wizard-step-label">Infos pratiques</div>
      </div>
      <div class="wizard-sep"></div>
      <div class="wizard-step" data-step="5">
        <div class="wizard-step-num">5</div>
        <div class="wizard-step-label">Aux alentours</div>
      </div>
    </div>

    <!-- Section 1: Infos g√©n√©rales -->
    <div class="form-section active" data-section="1">
      <div class="wiz-card">
        <div class="wiz-card-header">
          <div class="wiz-card-icon"><i class="fas fa-home"></i></div>
          <div>
            <h2 class="wiz-card-title">Informations G√©n√©rales</h2>
            <p class="wiz-card-sub">Commencez par les informations de base de votre logement</p>
          </div>
        </div>
        <div class="wiz-card-body">
          <div class="wiz-info-box"><i class="fas fa-info-circle"></i> Ces informations appara√Ætront sur la page d'accueil de votre livret</div>
          <div class="wiz-group">
            <label class="wiz-label">Nom du logement <span class="wiz-required">*</span><span class="wiz-hint">Ex: "Votre Pied-√†-Terre", "Appartement Cosy Centre-Ville"</span></label>
            <input class="wiz-input" name="propertyName" placeholder="Nom de votre logement" required type="text"/>
          </div>
          <div class="wiz-group">
            <label class="wiz-label">Photo de couverture <span class="wiz-required">*</span><span class="wiz-hint">Image principale (format recommand√©: 1920x1080px)</span></label>
            <div class="wiz-upload" onclick="document.getElementById('coverPhoto').click()">
              <i class="fas fa-cloud-upload-alt"></i>
              <p>Cliquez pour t√©l√©charger votre photo de couverture</p>
              <p class="wiz-upload-hint">JPG, PNG ou WebP (max 5MB)</p>
            </div>
            <input accept="image/*" id="coverPhoto" style="display:none;" type="file"/>
            <div class="image-preview" id="coverPhotoPreview"></div>
          </div>
          <div class="wiz-group">
            <label class="wiz-label">Message de bienvenue<span class="wiz-hint">Message d'accueil pour vos voyageurs</span></label>
            <textarea class="wiz-textarea" name="welcomeDescription" placeholder="Ex: Nous sommes ravis de vous accueillir dans cet appartement..."></textarea>
          </div>
          <div class="wiz-group">
            <label class="wiz-label">Votre num√©ro de t√©l√©phone <span class="wiz-required">*</span><span class="wiz-hint">Pour que vos voyageurs puissent vous contacter</span></label>
            <input class="wiz-input" name="contactPhone" placeholder="06 XX XX XX XX" required type="tel"/>
          </div>
        </div>
      </div>
      <div class="wiz-nav"><div></div><button class="wiz-btn-next" onclick="nextSection()" type="button">Suivant <i class="fas fa-arrow-right"></i></button></div>
    </div>

    <!-- Section 2: Acc√®s & Arriv√©e -->
    <div class="form-section" data-section="2">
      <div class="wiz-card">
        <div class="wiz-card-header">
          <div class="wiz-card-icon"><i class="fas fa-map-marker-alt"></i></div>
          <div>
            <h2 class="wiz-card-title">Acc√®s &amp; Arriv√©e</h2>
            <p class="wiz-card-sub">Comment vos voyageurs acc√®dent-ils √† votre logement ?</p>
          </div>
        </div>
        <div class="wiz-card-body">
          <div class="wiz-grid-2">
            <div class="wiz-group">
              <label class="wiz-label">Adresse <span class="wiz-required">*</span></label>
              <input class="wiz-input" name="address" placeholder="Num√©ro et rue" required type="text"/>
            </div>
            <div class="wiz-group">
              <label class="wiz-label">Code postal <span class="wiz-required">*</span></label>
              <input class="wiz-input" name="postalCode" placeholder="75001" required type="text"/>
            </div>
          </div>
          <div class="wiz-grid-2">
            <div class="wiz-group">
              <label class="wiz-label">Ville <span class="wiz-required">*</span></label>
              <input class="wiz-input" name="city" placeholder="Paris" required type="text"/>
            </div>
            <div class="wiz-group">
              <label class="wiz-label">Code bo√Æte √† cl√©s<span class="wiz-hint">Si applicable</span></label>
              <input class="wiz-input" name="keyboxCode" placeholder="Ex: 8670" type="text"/>
            </div>
          </div>
          <div class="wiz-group">
            <label class="wiz-label">Instructions d'acc√®s<span class="wiz-hint">Portail, √©tage, etc.</span></label>
            <textarea class="wiz-textarea" name="accessInstructions" placeholder="Ex: Poussez le portail, la bo√Æte √† cl√©s est √† gauche..."></textarea>
          </div>
          <div class="wiz-group">
            <label class="wiz-label">Photos de l'entr√©e<span class="wiz-hint">Portail, entr√©e, bo√Æte √† cl√©s...</span></label>
            <div class="wiz-upload" onclick="document.getElementById('entrancePhotos').click()">
              <i class="fas fa-images"></i>
              <p>T√©l√©charger les photos de l'entr√©e</p>
              <p class="wiz-upload-hint">Plusieurs images possibles</p>
            </div>
            <input accept="image/*" id="entrancePhotos" multiple style="display:none;" type="file"/>
            <div class="image-preview" id="entrancePhotosPreview"></div>
          </div>
          <hr class="wiz-divider"/>
          <div class="wiz-group">
            <label class="wiz-label">Parking<span class="wiz-hint">Informations sur le stationnement</span></label>
            <textarea class="wiz-textarea" name="parkingInfo" placeholder="Ex: Parking gratuit au 43-51 rue du March√©, 230 places..."></textarea>
          </div>
          <div class="wiz-group">
            <label class="wiz-label">Photos du parking</label>
            <div class="wiz-upload" onclick="document.getElementById('parkingPhotos').click()">
              <i class="fas fa-parking"></i>
              <p>T√©l√©charger les photos du parking</p>
            </div>
            <input accept="image/*" id="parkingPhotos" multiple style="display:none;" type="file"/>
            <div class="image-preview" id="parkingPhotosPreview"></div>
          </div>
        </div>
      </div>
      <div class="wiz-nav">
        <button class="wiz-btn-back" onclick="prevSection()" type="button"><i class="fas fa-arrow-left"></i> Pr√©c√©dent</button>
        <button class="wiz-btn-next" onclick="nextSection()" type="button">Suivant <i class="fas fa-arrow-right"></i></button>
      </div>
    </div>

    <!-- Section 3: Le Logement -->
    <div class="form-section" data-section="3">
      <div class="wiz-card">
        <div class="wiz-card-header">
          <div class="wiz-card-icon"><i class="fas fa-door-open"></i></div>
          <div>
            <h2 class="wiz-card-title">Le Logement</h2>
            <p class="wiz-card-sub">Pr√©sentez les diff√©rentes pi√®ces et espaces</p>
          </div>
        </div>
        <div class="wiz-card-body">
          <div class="wiz-warn-box"><i class="fas fa-lightbulb"></i> Ajoutez autant de pi√®ces que n√©cessaire</div>
          <div id="roomsContainer"></div>
          <button class="wiz-add-btn" onclick="addRoom()" type="button"><i class="fas fa-plus"></i> Ajouter une pi√®ce / un espace</button>
        </div>
      </div>
      <div class="wiz-nav">
        <button class="wiz-btn-back" onclick="prevSection()" type="button"><i class="fas fa-arrow-left"></i> Pr√©c√©dent</button>
        <button class="wiz-btn-next" onclick="nextSection()" type="button">Suivant <i class="fas fa-arrow-right"></i></button>
      </div>
    </div>

    <!-- Section 4: Infos pratiques -->
    <div class="form-section" data-section="4">
      <div class="wiz-card">
        <div class="wiz-card-header">
          <div class="wiz-card-icon"><i class="fas fa-info-circle"></i></div>
          <div>
            <h2 class="wiz-card-title">Informations Pratiques</h2>
            <p class="wiz-card-sub">WiFi, √©quipements, consignes et tout ce qui est utile</p>
          </div>
        </div>
        <div class="wiz-card-body">
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-wifi"></i> WiFi</div>
            <div class="wiz-grid-2">
              <div class="wiz-group">
                <label class="wiz-label">Nom du r√©seau (SSID)</label>
                <input class="wiz-input" name="wifiSSID" placeholder="Nom du r√©seau" type="text"/>
              </div>
              <div class="wiz-group">
                <label class="wiz-label">Mot de passe</label>
                <input class="wiz-input" name="wifiPassword" placeholder="Mot de passe" type="text"/>
              </div>
            </div>
          </div>
          <hr class="wiz-divider"/>
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-clipboard-list"></i> Consignes de d√©part</div>
            <div class="wiz-group">
              <label class="wiz-label">Heure de d√©part<span class="wiz-hint">Ex: 11h, 10h30</span></label>
              <input class="wiz-input" name="checkoutTime" placeholder="11h" type="text"/>
            </div>
            <div class="wiz-group">
              <label class="wiz-label">Instructions de d√©part</label>
              <textarea class="wiz-textarea" name="checkoutInstructions" placeholder="- √âteindre toutes les lumi√®res&#10;- Laver la vaisselle&#10;- Poser les serviettes au sol..." style="min-height:110px;"></textarea>
            </div>
          </div>
          <hr class="wiz-divider"/>
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-toolbox"></i> √âquipements disponibles</div>
            <div class="wiz-group">
              <label class="wiz-label">Liste des √©quipements<span class="wiz-hint">Un √©quipement par ligne</span></label>
              <textarea class="wiz-textarea" name="equipmentList" placeholder="Machine √† caf√© Nespresso&#10;Micro-ondes&#10;Machine √† laver..." style="min-height:140px;"></textarea>
            </div>
          </div>
          <hr class="wiz-divider"/>
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-exclamation-triangle"></i> R√®gles importantes</div>
            <div class="wiz-group">
              <label class="wiz-label">R√®gles et avertissements<span class="wiz-hint">Poutre basse, non-fumeur, etc.</span></label>
              <textarea class="wiz-textarea" name="importantRules" placeholder="Entrez les r√®gles importantes..."></textarea>
            </div>
          </div>
          <hr class="wiz-divider"/>
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-train"></i> Transports</div>
            <div class="wiz-group">
              <label class="wiz-label">Informations transports<span class="wiz-hint">Acc√®s transports en commun, gares, etc.</span></label>
              <textarea class="wiz-textarea" name="transportInfo" placeholder="Ex: Bus ligne 15 √† 1 minute √† pied..."></textarea>
            </div>
          </div>
        </div>
      </div>
      <div class="wiz-nav">
        <button class="wiz-btn-back" onclick="prevSection()" type="button"><i class="fas fa-arrow-left"></i> Pr√©c√©dent</button>
        <button class="wiz-btn-next" onclick="nextSection()" type="button">Suivant <i class="fas fa-arrow-right"></i></button>
      </div>
    </div>

    <!-- Section 5: Aux alentours -->
    <div class="form-section" data-section="5">
      <div class="wiz-card">
        <div class="wiz-card-header">
          <div class="wiz-card-icon"><i class="fas fa-map-marked-alt"></i></div>
          <div>
            <h2 class="wiz-card-title">Aux Alentours</h2>
            <p class="wiz-card-sub">Restaurants, commerces et lieux √† visiter</p>
          </div>
        </div>
        <div class="wiz-card-body">
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-utensils"></i> Restaurants &amp; Bars</div>
            <div id="restaurantsContainer"></div>
            <button class="wiz-add-btn" onclick="addRestaurant()" type="button"><i class="fas fa-plus"></i> Ajouter un restaurant / bar</button>
          </div>
          <hr class="wiz-divider"/>
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-shopping-bag"></i> Commerces</div>
            <div class="wiz-group">
              <label class="wiz-label">Liste des commerces<span class="wiz-hint">Un commerce par ligne</span></label>
              <textarea class="wiz-textarea" name="shopsList" placeholder="FRANPRIX - 6 rue de Pontoise&#10;Boulangerie LA POTERNE - Place du march√©..." style="min-height:110px;"></textarea>
            </div>
          </div>
          <hr class="wiz-divider"/>
          <div class="wiz-subsection">
            <div class="wiz-subsection-title"><i class="fas fa-map-signs"></i> Lieux √† Visiter</div>
            <div id="placesContainer"></div>
            <button class="wiz-add-btn" onclick="addPlace()" type="button"><i class="fas fa-plus"></i> Ajouter un lieu √† visiter</button>
          </div>
        </div>
      </div>
      <div class="wiz-nav">
        <button class="wiz-btn-back" onclick="prevSection()" type="button"><i class="fas fa-arrow-left"></i> Pr√©c√©dent</button>
        <button class="wiz-btn-submit" type="submit"><i class="fas fa-check-circle"></i> Cr√©er le livret</button>
      </div>
    </div>

  </form>

  <!-- ‚îÄ‚îÄ Succ√®s ‚îÄ‚îÄ -->
  <div id="successMessage" style="display:none;">
    <div class="wiz-success">
      <div class="wiz-success-icon"><i class="fas fa-check"></i></div>
      <h2>Livret cr√©√© avec succ√®s !</h2>
      <p>Votre livret d'accueil personnalis√© a √©t√© g√©n√©r√©.</p>
      <div class="wiz-qr-box">
        <h3><i class="fas fa-qrcode"></i> QR Code du livret</h3>
        <div id="qrcode" style="display:flex;justify-content:center;margin-bottom:12px;"></div>
        <p style="font-size:12px;color:#9CA3AF;margin-bottom:12px;">Scannez pour acc√©der directement au livret</p>
        <button class="wiz-btn-next" onclick="downloadQRCode()" style="width:100%;justify-content:center;"><i class="fas fa-download"></i> T√©l√©charger le QR Code</button>
      </div>
      <div class="wiz-success-actions">
        <button class="wiz-btn-next" onclick="viewWelcomeBook()"><i class="fas fa-eye"></i> Voir le livret</button>
        <button class="wiz-btn-back" onclick="copyWelcomeBookLink(this)"><i class="fas fa-copy"></i> Copier le lien</button>
        <button class="wiz-btn-back" onclick="modifyCurrentLivret()"><i class="fas fa-edit"></i> Modifier</button>
      </div>
    </div>
  </div>

</div><!-- .welcome-container -->
</main>
</div>

<script>

const API_BASE = 'https://lcc-booking-manager.onrender.com';

window.getAuthToken = window.getAuthToken || (() => localStorage.getItem('lcc_token') || '');
let currentUniqueId = null; // Pour savoir si on modifie ou on cr√©e

// ----------------------------
// Navigation par sections (wizard)
// ----------------------------
let currentSectionIndex = 0;

function getSections() {
  return Array.from(document.querySelectorAll('.form-section'));
}

function showSection(index) {
  const sections = getSections();
  if (!sections.length) return;

  currentSectionIndex = Math.max(0, Math.min(index, sections.length - 1));
  sections.forEach((sec, i) => sec.classList.toggle('active', i === currentSectionIndex));

  // Scroll top du formulaire
  const form = document.getElementById('welcomeForm');
  if (form) form.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

function nextSection() {
  const next = currentSectionIndex + 1;
  showSection(next);
  updateStepperDirect(next);
  updateProgressBar(next);
}

function prevSection() {
  const prev = currentSectionIndex - 1;
  showSection(prev);
  updateStepperDirect(prev);
  updateProgressBar(prev);
}

function updateStepperDirect(index) {
  document.querySelectorAll('.wizard-step').forEach((step, i) => {
    step.classList.remove('active','done');
    if (i === index) step.classList.add('active');
    else if (i < index) step.classList.add('done');
  });
  // Update progress bar
  updateProgressBar(index);
}

function updateProgressBar(index) {
  const total = 5;
  const pct = Math.round(((index) / (total - 1)) * 100);
  const bar = document.getElementById('wizProgressBar');
  const label = document.getElementById('wizProgressLabel');
  if (bar) bar.style.width = pct + '%';
  if (label) label.textContent = '√âtape ' + (index + 1) + ' / ' + total;
  const pctEl = document.getElementById('wizProgressPct');
  if (pctEl) pctEl.textContent = pct + '%';
}

// ----------------------------
// Upload + preview images
// ----------------------------
function setupImageUpload(inputId, previewId, multiple = false) {
  const input = document.getElementById(inputId);
  const preview = document.getElementById(previewId);
  if (!input || !preview) return;

  input.addEventListener('change', () => {
    // Reset preview
    preview.innerHTML = '';

    const files = Array.from(input.files || []);
    if (!files.length) return;

    files.forEach(file => {
      if (!file.type || !file.type.startsWith('image/')) return;

      const reader = new FileReader();
      reader.onload = (ev) => {
        const div = document.createElement('div');
        div.className = 'image-preview-item';
        div.innerHTML = `
          <img src="${ev.target.result}" alt="preview">
        `;
        preview.appendChild(div);
      };
      reader.readAsDataURL(file);
    });
  });
}

// ----------------------------
// Collecte des donn√©es + sauvegarde
// ----------------------------
function collectFormData() {
  const formData = new FormData();

  // Champs texte simples
  const fields = [
    'propertyName','welcomeDescription','contactPhone',
    'address','postalCode','city','keyboxCode',
    'accessInstructions','parkingInfo','wifiSSID',
    'wifiPassword','checkoutTime','checkoutInstructions',
    'equipmentList','importantRules','transportInfo','shopsList'
  ];
  fields.forEach(f => formData.append(f, document.querySelector(`[name="${f}"]`)?.value || ''));

  // Pi√®ces
  const rooms = [];
  document.querySelectorAll('#roomsContainer .room-block').forEach(block => {
    const name = block.querySelector('input[name*="[name]"]')?.value || '';
    const description = block.querySelector('textarea[name*="[description]"]')?.value || '';
    rooms.push({ name, description });
  });
  formData.append('rooms', JSON.stringify(rooms));

  // Restaurants
  const restaurants = [];
  document.querySelectorAll('#restaurantsContainer .restaurant-block').forEach(block => {
    const name = block.querySelector('input[name*="[name]"]')?.value || '';
    const phone = block.querySelector('input[name*="[phone]"]')?.value || '';
    const address = block.querySelector('input[name*="[address]"]')?.value || '';
    const description = block.querySelector('textarea[name*="[description]"]')?.value || '';
    restaurants.push({ name, phone, address, description });
  });
  formData.append('restaurants', JSON.stringify(restaurants));

  // Lieux
  const places = [];
  document.querySelectorAll('#placesContainer .place-block').forEach(block => {
    const name = block.querySelector('input[name*="[name]"]')?.value || '';
    const description = block.querySelector('textarea[name*="[description]"]')?.value || '';
    places.push({ name, description });
  });
  formData.append('places', JSON.stringify(places));

  // Fichiers
  const cover = document.getElementById('coverPhoto')?.files?.[0];
  if (cover) formData.append('coverPhoto', cover);

  const entrance = document.getElementById('entrancePhotos')?.files || [];
  for (const f of entrance) formData.append('entrancePhotos', f);

  const parking = document.getElementById('parkingPhotos')?.files || [];
  for (const f of parking) formData.append('parkingPhotos', f);

  // uniqueId si √©dition
  if (currentUniqueId) formData.append('uniqueId', currentUniqueId);

  return formData;
}

async function saveWelcomeBook(e) {
  if (e) e.preventDefault();

  try {
    const formData = collectFormData();

    const response = await fetch(`${API_BASE}/api/welcome-books/create`, {
      method: 'POST',
      body: formData
    });

    const raw = await response.text();
    let data = null;
    try { data = raw ? JSON.parse(raw) : null; } catch (_) { data = null; }

    if (!response.ok || !data || !data.success) {
      alert((data && (data.error || data.message)) ? (data.error || data.message) : `Erreur sauvegarde (${response.status})`);
      return;
    }

    // Si le backend renvoie un uniqueId, on le garde
    if (data.uniqueId) currentUniqueId = data.uniqueId;

    // Affichage succ√®s
    hideFormShowSuccess();
    document.getElementById('successMessage').style.display = 'block';

    // Recharge la liste pour voir le livret
    await loadLivretsList();
  } catch (err) {
    console.error("Erreur sauvegarde:", err);
    alert("Erreur lors de la sauvegarde.");
  }
}

function createAnother() {
  currentUniqueId = null;
  const form = document.getElementById('welcomeForm');
  if (form) form.reset();

  // Reset previews + containers
  const previews = ['coverPhotoPreview','entrancePhotosPreview','parkingPhotosPreview'];
  previews.forEach(id => { const el = document.getElementById(id); if (el) el.innerHTML = ''; });

  const rooms = document.getElementById('roomsContainer'); if (rooms) rooms.innerHTML = '';
  const rests = document.getElementById('restaurantsContainer'); if (rests) rests.innerHTML = '';
  const places = document.getElementById('placesContainer'); if (places) places.innerHTML = '';

  roomCounter = 0; restaurantCounter = 0; placeCounter = 0;
  addRoom(); addRestaurant(); addPlace();

  document.getElementById('successMessage').style.display = 'none';
  setDisplayById('welcomeForm','block');
  showSection(0);
}

// Init
document.addEventListener('DOMContentLoaded', () => {
  setupImageUpload('coverPhoto', 'coverPhotoPreview', false);
  setupImageUpload('entrancePhotos', 'entrancePhotosPreview', true);
  setupImageUpload('parkingPhotos', 'parkingPhotosPreview', true);

  const form = document.getElementById('welcomeForm');
  if (form) form.addEventListener('submit', saveWelcomeBook);

  // Sections default
  showSection(0);

  // Pr√©pare les blocs par d√©faut
  try { addRoom(); addRestaurant(); addPlace(); } catch (_) {}
});

// Charger la liste des livrets au d√©marrage
async function loadLivretsList() {
  try {
    const response = await fetch(`${API_BASE}/api/welcome-books/user/list`, {
      headers: { 'Authorization': `Bearer ${localStorage.getItem('lcc_token')}` }
    });
    
    const data = await response.json();
    
    if (data.success && data.welcomeBooks && data.welcomeBooks.length > 0) {
      displayLivretsList(data.welcomeBooks);
    } else {
      document.getElementById('livretsList').innerHTML = '<p style="color: #64748b; text-align: center;">Aucun livret pour le moment.</p>';
    }
  } catch (error) {
    console.error('Erreur chargement livrets:', error);
    document.getElementById('livretsList').innerHTML = '<p style="color: #e53e3e;">Erreur lors du chargement des livrets.</p>';
  }
}


// Cr√©er un nouveau livret
function createNewLivret() {
  currentUniqueId = null;
  document.getElementById('welcomeForm').reset();
  document.getElementById('livretsListSection').style.display = 'none';
  document.getElementById('welcomeForm').style.display = 'block';
  
  // Remonter en haut de la page
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Voir un livret
function viewLivret(uniqueId) {
  window.open(`${API_BASE}/welcome/${uniqueId}`, '_blank');
}

// Supprimer un livret
// Modifier un livret (chargement + remplissage du formulaire)
async function editLivret(uniqueId) {
  try {
    currentUniqueId = uniqueId;

    const response = await fetch(`${API_BASE}/api/welcome-books/public/${uniqueId}`);
    const data = await response.json();

    if (data && data.success && data.book) {
      fillFormWithData(data.book);
      document.getElementById('livretsListSection').style.display = 'none';
      setDisplayById('welcomeForm','block');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    } else {
      alert((data && data.error) ? data.error : "Impossible de charger ce livret.");
    }
  } catch (err) {
    console.error("Erreur editLivret:", err);
    alert("Erreur lors du chargement du livret.");
  }
}
async function copyWelcomeBookLink(buttonEl) {
    try {
      const url =
        window.welcomeBookUrl ||
        (typeof currentUniqueId !== "undefined" && currentUniqueId
          ? `${API_BASE}/welcome/${currentUniqueId}`
          : "");

      if (!url) {
        alert("Lien indisponible (uniqueId manquant)");
        return;
      }

      await navigator.clipboard.writeText(url);

      if (buttonEl) {
        const old = buttonEl.innerHTML;
        buttonEl.innerHTML = '<i class="fas fa-check"></i> Lien copi√©';
        setTimeout(() => (buttonEl.innerHTML = old), 1500);
      } else {
        alert("Lien copi√© ‚úÖ");
      }
    } catch (e) {
      const url =
        window.welcomeBookUrl ||
        (currentUniqueId ? `${API_BASE}/welcome/${currentUniqueId}` : "");
      prompt("Copie le lien :", url);
    }
  }
  async function modifyCurrentLivret() {
  if (!currentUniqueId) {
    alert("Impossible de modifier : identifiant manquant.");
    return;
  }
  await editLivret(currentUniqueId);
}
async function deleteLivret(uniqueId) {
  if (!confirm('√ätes-vous s√ªr de vouloir supprimer ce livret ?')) return;
  
  try {
    const response = await fetch(`${API_BASE}/api/welcome-books/by-unique/${uniqueId}`, {
      method: 'DELETE',
      headers: { 'Authorization': `Bearer ${localStorage.getItem('lcc_token')}` }
    });
    
    const raw = await response.text();
      let data = null;
      try { data = raw ? JSON.parse(raw) : null; } catch (e) { data = null; }

      if (data && data.success) {
      alert('Livret supprim√© avec succ√®s');
      loadLivretsList();
    } else {
      alert('Erreur lors de la suppression');
    }
  } catch (error) {
    console.error('Erreur suppression:', error);
    alert('Erreur lors de la suppression');
  }
}
function downloadQRCode(uniqueId) {
  try {
    // 0) Si on a un uniqueId, on peut toujours reconstruire l'URL
    const url = uniqueId ? `${API_BASE}/welcome/${uniqueId}` : (window.welcomeBookUrl || null);

    // 1) Cas 1: un <img> d√©di√© (si tu l'utilises dans une liste)
    const img =
      (uniqueId && document.getElementById(`qrCodeImg-${uniqueId}`)) ||
      (uniqueId && document.querySelector(`[data-qr="${uniqueId}"]`)) ||
      document.querySelector('#qrcode img');

    if (img && img.src) {
      const a = document.createElement('a');
      a.href = img.src;
      a.download = `qr-${uniqueId || 'welcome-book'}.png`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      return;
    }

    // 2) Cas 2: QRCodeJS rend souvent un <canvas>
    const canvas = document.querySelector('#qrcode canvas');
    if (canvas && canvas.toDataURL) {
      const a = document.createElement('a');
      a.href = canvas.toDataURL('image/png');
      a.download = `qr-${uniqueId || 'welcome-book'}.png`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      return;
    }

    // 3) Fallback: si on a l'URL mais pas de rendu, on g√©n√®re un QR temporaire puis on t√©l√©charge
    if (url && window.QRCode) {
      const tmp = document.createElement('div');
      tmp.style.position = 'fixed';
      tmp.style.left = '-9999px';
      tmp.style.top = '-9999px';
      document.body.appendChild(tmp);

      new QRCode(tmp, { text: url, width: 256, height: 256 });

      // QRCodeJS peut mettre un img ou un canvas
      const tmpImg = tmp.querySelector('img');
      const tmpCanvas = tmp.querySelector('canvas');

      const dataUrl = tmpImg?.src || (tmpCanvas?.toDataURL ? tmpCanvas.toDataURL('image/png') : null);
      document.body.removeChild(tmp);

      if (dataUrl) {
        const a = document.createElement('a');
        a.href = dataUrl;
        a.download = `qr-${uniqueId || 'welcome-book'}.png`;
        document.body.appendChild(a);
        a.click();
        a.remove();
        return;
      }
    }

    alert("QR Code introuvable");
  } catch (e) {
    console.error("downloadQRCode error:", e);
    alert("Impossible de t√©l√©charger le QR Code.");
  }
}
// Remplir le formulaire avec les donn√©es d'un livret
// Affiche une image d√©j√† existante (URL) dans un container de preview
function showExistingImage(containerId, url) {
  const container = document.getElementById(containerId);
  if (!container || !url) return;

  const wrapper = document.createElement('div');
  wrapper.className = 'preview-thumb';

  const img = document.createElement('img');
  img.src = url;
  img.alt = 'Photo existante';
  img.loading = 'lazy';

  wrapper.appendChild(img);
  container.appendChild(wrapper);
}

// Compteurs pour les sections r√©p√©tables
let roomCounter = 0;
let restaurantCounter = 0;
let placeCounter = 0;

function addRoom() {
  const container = document.getElementById('roomsContainer');
  if (!container) return;
  roomCounter += 1;

  const block = document.createElement('div');
  block.className = 'repeat-block room-block';

  block.innerHTML = `
    <div class="field">
      <label>Nom de la pi√®ce</label>
      <input type="text" name="room[${roomCounter}][name]" placeholder="Ex: Chambre 1">
    </div>
    <div class="field">
      <label>Description</label>
      <textarea name="room[${roomCounter}][description]" rows="3" placeholder="Lit, rangement, etc."></textarea>
    </div>
    <hr/>
  `;
  container.appendChild(block);
}

function addRestaurant() {
  const container = document.getElementById('restaurantsContainer');
  if (!container) return;
  restaurantCounter += 1;

  const block = document.createElement('div');
  block.className = 'repeat-block restaurant-block';

  block.innerHTML = `
    <div class="field">
      <label>Nom</label>
      <input type="text" name="restaurant[${restaurantCounter}][name]" placeholder="Nom du restaurant">
    </div>
    <div class="field">
      <label>T√©l√©phone</label>
      <input type="text" name="restaurant[${restaurantCounter}][phone]" placeholder="01 23 45 67 89">
    </div>
    <div class="field">
      <label>Adresse</label>
      <input type="text" name="restaurant[${restaurantCounter}][address]" placeholder="Adresse">
    </div>
    <div class="field">
      <label>Description</label>
      <textarea name="restaurant[${restaurantCounter}][description]" rows="3" placeholder="Pourquoi tu le recommandes"></textarea>
    </div>
    <hr/>
  `;
  container.appendChild(block);
}

function addPlace() {
  const container = document.getElementById('placesContainer');
  if (!container) return;
  placeCounter += 1;

  const block = document.createElement('div');
  block.className = 'repeat-block place-block';

  block.innerHTML = `
    <div class="field">
      <label>Nom</label>
      <input type="text" name="place[${placeCounter}][name]" placeholder="Lieu √† visiter">
    </div>
    <div class="field">
      <label>Description</label>
      <textarea name="place[${placeCounter}][description]" rows="3" placeholder="Infos utiles"></textarea>
    </div>
    <hr/>
  `;
  container.appendChild(block);
}

function fillFormWithData(data) {
  if (!data) return;

  // Champs simples
  const fields = [
    'propertyName', 'welcomeDescription', 'contactPhone',
    'address', 'postalCode', 'city', 'keyboxCode',
    'accessInstructions', 'parkingInfo', 'wifiSSID',
    'wifiPassword', 'checkoutTime', 'checkoutInstructions',
    'equipmentList', 'importantRules', 'transportInfo', 'shopsList'
  ];

  fields.forEach(f => {
    const el = document.querySelector(`[name="${f}"]`);
    if (!el) return;
    // On accepte 0 / false / "" : on teste uniquement undefined/null
    if (data[f] !== undefined && data[f] !== null) el.value = data[f];
  });

  // Photos existantes (si pr√©sentes en URL)
  if (data.photos) {
    if (data.photos.cover) showExistingImage('coverPhotoPreview', data.photos.cover);
    if (Array.isArray(data.photos.entrance)) data.photos.entrance.forEach(u => showExistingImage('entrancePhotosPreview', u));
    if (Array.isArray(data.photos.parking)) data.photos.parking.forEach(u => showExistingImage('parkingPhotosPreview', u));
  }

  // Pi√®ces
  document.getElementById('roomsContainer').innerHTML = '';
  roomCounter = 0;
  if (Array.isArray(data.rooms) && data.rooms.length) {
    data.rooms.forEach(r => {
      addRoom();
      document.querySelector(`[name="room[${roomCounter}][name]"]`).value = r.name || '';
      document.querySelector(`[name="room[${roomCounter}][description]"]`).value = r.description || '';
    });
  } else {
    addRoom();
  }

  // Restaurants
  document.getElementById('restaurantsContainer').innerHTML = '';
  restaurantCounter = 0;
  if (Array.isArray(data.restaurants) && data.restaurants.length) {
    data.restaurants.forEach(r => {
      addRestaurant();
      document.querySelector(`[name="restaurant[${restaurantCounter}][name]"]`).value = r.name || '';
      document.querySelector(`[name="restaurant[${restaurantCounter}][phone]"]`).value = r.phone || '';
      document.querySelector(`[name="restaurant[${restaurantCounter}][address]"]`).value = r.address || '';
      document.querySelector(`[name="restaurant[${restaurantCounter}][description]"]`).value = r.description || '';
    });
  } else {
    addRestaurant();
  }

  // Lieux
  document.getElementById('placesContainer').innerHTML = '';
  placeCounter = 0;
  if (Array.isArray(data.places) && data.places.length) {
    data.places.forEach(p => {
      addPlace();
      document.querySelector(`[name="place[${placeCounter}][name]"]`).value = p.name || '';
      document.querySelector(`[name="place[${placeCounter}][description]"]`).value = p.description || '';
    });
  } else {
    addPlace();
  }

  // URL public / QR (on se base sur currentUniqueId si on √©dite)
  const uid = currentUniqueId || data.uniqueId;
  if (uid) window.welcomeBookUrl = `${API_BASE}/welcome/${uid}`;
}

// Appeler loadLivretsList() au chargement de la page() au chargement de la page
document.addEventListener('DOMContentLoaded', loadLivretsList);
// ----------------------------
// Helpers d'affichage (liste/form/succ√®s)
// ----------------------------
function setDisplayById(id, display) {
  const el = document.getElementById(id);
  if (el) el.style.display = display;
}

function hideFormShowSuccess() {
  setDisplayById('welcomeForm', 'none');
  setDisplayById('successMessage', 'block');
}

function showFormHideLists() {
  setDisplayById('livretsListSection', 'none');
  setDisplayById('successMessage', 'none');
  setDisplayById('welcomeForm', 'block');
  try { showSection(0); } catch (_) {}
}

function createNewLivret() {
  currentUniqueId = null;
  const form = document.getElementById('welcomeForm');
  if (form) form.reset();
  showFormHideLists();
}


</script>

<script>
// ‚îÄ‚îÄ Redesign helpers ‚îÄ‚îÄ
function copyLivretLink(uniqueId, btn) {
  const url = API_BASE + '/welcome/' + uniqueId;
  navigator.clipboard.writeText(url).then(() => {
    const old = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-check"></i>';
    btn.style.background = 'rgba(26,122,94,.2)';
    setTimeout(() => { btn.innerHTML = old; btn.style.background = ''; }, 1500);
  }).catch(() => prompt('Copie le lien :', url));
}

// Update stepper UI
function updateStepper(index) {
  document.querySelectorAll('.wizard-step').forEach((step, i) => {
    step.classList.remove('active','done');
    if (i === index) step.classList.add('active');
    else if (i < index) step.classList.add('done');
  });
}

// stepper updated directly in nextSection/prevSection

// Redesign displayLivretsList
function displayLivretsList(livrets) {
  const grid = document.getElementById('livretsList');
  if (!livrets || !livrets.length) {
    grid.innerHTML = '<p style="color:#7A8695;grid-column:1/-1;text-align:center;padding:24px">Aucun livret pour le moment.</p>';
    appendAddCard(grid);
    return;
  }
  const emojis = ['üìñ','üè°','üåø','üîë','üèñÔ∏è','üåÑ','üõãÔ∏è','‚ú®'];
  const html = livrets.map((livret, idx) => `
    <div class="livret-card">
      <div class="livret-card-hero">
        <div class="livret-card-hero-icon">${emojis[idx % emojis.length]}</div>
        <div style="position:absolute;top:10px;right:10px;background:rgba(255,255,255,.2);backdrop-filter:blur(8px);color:white;font-size:11px;font-weight:600;padding:3px 10px;border-radius:999px;">‚óè Actif</div>
      </div>
      <div class="livret-card-body">
        <div>
          <div class="livret-card-name">${livret.propertyName || 'Sans nom'}</div>
          <div class="livret-card-date"><i class="fas fa-clock" style="font-size:10px;"></i> Modifi√© le ${new Date(livret.updatedAt).toLocaleDateString('fr-FR')}</div>
        </div>
        <div class="livret-card-actions">
          <button class="btn-lv btn-lv-edit" onclick="editLivret('${livret.uniqueId}')"><i class="fas fa-edit"></i> Modifier</button>
          <button class="btn-lv btn-lv-view" onclick="viewLivret('${livret.uniqueId}')"><i class="fas fa-eye"></i> Voir</button>
          <button class="btn-lv btn-lv-qr" onclick="copyLivretLink('${livret.uniqueId}', this)" title="Copier le lien"><i class="fas fa-link"></i></button>
          <button class="btn-lv btn-lv-delete" onclick="deleteLivret('${livret.uniqueId}')"><i class="fas fa-trash"></i></button>
        </div>
      </div>
    </div>
  `).join('');
  grid.innerHTML = html;
  appendAddCard(grid);
}

function appendAddCard(grid) {
  // Update count in header
  const cards = grid.querySelectorAll('.livret-card');
  // Update banner subtitle with count
  const subEl = document.querySelector('.welcome-tip-sub');
  if (subEl && cards.length > 0) {
    subEl.innerHTML = '<strong style="color:white;">' + cards.length + ' livret' + (cards.length > 1 ? 's' : '') + ' actif' + (cards.length > 1 ? 's' : '') + '</strong> ¬∑ Partagez-les via lien ou QR Code, vos voyageurs y acc√®dent sans application.';
  }

  const add = document.createElement('div');
  add.className = 'livret-card-add';
  add.onclick = createNewLivret;
  add.innerHTML = `
    <div class="livret-card-add-icon"><i class="fas fa-plus"></i></div>
    <div class="livret-card-add-label">Nouveau livret</div>
    <div class="livret-card-add-sub">Cr√©er un livret d'accueil</div>
  `;
  grid.appendChild(add);
}

// Redesign addRoom
window.addRoom = function() {
  const container = document.getElementById('roomsContainer');
  if (!container) return;
  roomCounter += 1;
  const block = document.createElement('div');
  block.className = 'wiz-repeat-block room-block';
  block.innerHTML = `
    <div class="wiz-repeat-header">
      <span class="wiz-repeat-title"><i class="fas fa-door-open" style="color:#1A7A5E;margin-right:6px;"></i>Pi√®ce ${roomCounter}</span>
      <button type="button" class="wiz-remove-btn" onclick="this.closest('.wiz-repeat-block').remove()"><i class="fas fa-times"></i></button>
    </div>
    <div class="wiz-group">
      <label class="wiz-label">Nom de la pi√®ce</label>
      <input type="text" class="wiz-input" name="room[${roomCounter}][name]" placeholder="Ex: Chambre 1">
    </div>
    <div class="wiz-group" style="margin-bottom:0">
      <label class="wiz-label">Description</label>
      <textarea class="wiz-textarea" name="room[${roomCounter}][description]" placeholder="Lit, rangement, etc."></textarea>
    </div>
  `;
  container.appendChild(block);
};

window.addRestaurant = function() {
  const container = document.getElementById('restaurantsContainer');
  if (!container) return;
  restaurantCounter += 1;
  const block = document.createElement('div');
  block.className = 'wiz-repeat-block restaurant-block';
  block.innerHTML = `
    <div class="wiz-repeat-header">
      <span class="wiz-repeat-title"><i class="fas fa-utensils" style="color:#1A7A5E;margin-right:6px;"></i>Restaurant / Bar ${restaurantCounter}</span>
      <button type="button" class="wiz-remove-btn" onclick="this.closest('.wiz-repeat-block').remove()"><i class="fas fa-times"></i></button>
    </div>
    <div class="wiz-grid-2">
      <div class="wiz-group">
        <label class="wiz-label">Nom</label>
        <input type="text" class="wiz-input" name="restaurant[${restaurantCounter}][name]" placeholder="Nom du restaurant">
      </div>
      <div class="wiz-group">
        <label class="wiz-label">T√©l√©phone</label>
        <input type="text" class="wiz-input" name="restaurant[${restaurantCounter}][phone]" placeholder="01 23 45 67 89">
      </div>
    </div>
    <div class="wiz-group">
      <label class="wiz-label">Adresse</label>
      <input type="text" class="wiz-input" name="restaurant[${restaurantCounter}][address]" placeholder="Adresse">
    </div>
    <div class="wiz-group" style="margin-bottom:0">
      <label class="wiz-label">Pourquoi le recommander ?</label>
      <textarea class="wiz-textarea" name="restaurant[${restaurantCounter}][description]" placeholder="Cuisine, ambiance, sp√©cialit√©..."></textarea>
    </div>
  `;
  container.appendChild(block);
};

window.addPlace = function() {
  const container = document.getElementById('placesContainer');
  if (!container) return;
  placeCounter += 1;
  const block = document.createElement('div');
  block.className = 'wiz-repeat-block place-block';
  block.innerHTML = `
    <div class="wiz-repeat-header">
      <span class="wiz-repeat-title"><i class="fas fa-map-marker-alt" style="color:#1A7A5E;margin-right:6px;"></i>Lieu ${placeCounter}</span>
      <button type="button" class="wiz-remove-btn" onclick="this.closest('.wiz-repeat-block').remove()"><i class="fas fa-times"></i></button>
    </div>
    <div class="wiz-group">
      <label class="wiz-label">Nom</label>
      <input type="text" class="wiz-input" name="place[${placeCounter}][name]" placeholder="Lieu √† visiter">
    </div>
    <div class="wiz-group" style="margin-bottom:0">
      <label class="wiz-label">Description</label>
      <textarea class="wiz-textarea" name="place[${placeCounter}][description]" placeholder="Infos utiles, pourquoi y aller..."></textarea>
    </div>
  `;
  container.appendChild(block);
};
</script>

<script src="/js/bh-layout.js"></script>
<script src="/js/logout-fix.js"></script>
<script src="/js/mobile-native-experience.js"></script>
<script src="/js/mobile-tabs-handler.js"></script>
<script src="/js/messages-badge-desktop-mobile.js"></script>

<script>
// Hide bh-layout injected page title
document.addEventListener('DOMContentLoaded', function() {
  // bh-layout injects into #bhHeader - hide the page title part
  setTimeout(function() {
    var hdr = document.getElementById('bhHeader');
    if (hdr) {
      // Hide any h1/h2 and .page-title inside bhHeader
      hdr.querySelectorAll('h1,h2,.page-title,.header-page-title,.bh-page-title,.page-header').forEach(function(el) {
        el.style.display = 'none';
      });
    }
    // Also hide any .page-title injected directly into .container or main
    document.querySelectorAll('.container .page-title, .main-content > .page-title, .welcome-container > .page-title').forEach(function(el) {
      el.style.display = 'none';
    });
  }, 100);
});
</script>

</body>
</html>
