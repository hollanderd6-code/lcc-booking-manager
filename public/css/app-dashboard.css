/* ============================================================
   APP-DASHBOARD-FIXES.CSS
   Correctifs ciblés pour les composants non stylés dans app-14
   
   À inclure APRÈS bh-design-system-v3.css et app-dashboard.css
   0 × !important
   ============================================================ */


/* ============================================================
   1. KPI CARDS — structure interne réelle
   ============================================================ */

/* Grille des KPI — fonctionne sur <section> aussi */
section.kpi-grid,
.kpi-grid-section,
.kpi-cards-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

/* La card elle-même (article.kpi-card) */
article.kpi-card {
  background: var(--cream-warm);
  border: 1px solid var(--border-warm);
  border-radius: var(--radius-lg);
  padding: 18px 20px;
  transition: transform .2s var(--ease-out), box-shadow .2s, border-color .15s;
}
[data-theme="dark"] article.kpi-card {
  background: #111827;
  border-color: rgba(255,255,255,.07);
}
article.kpi-card.kpi-card--clickable {
  cursor: pointer;
}
article.kpi-card.kpi-card--clickable:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-float);
  border-color: var(--sand);
}

/* Header de la KPI card (label + pill) */
.kpi-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
  gap: 8px;
}

/* Label de la KPI */
.kpi-label {
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .09em;
  color: var(--text-tertiary);
  line-height: 1.3;
}

/* Pill dans le header KPI */
.kpi-pill {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 9px;
  border-radius: var(--radius-full);
  font-size: 10.5px;
  font-weight: 600;
  white-space: nowrap;
}
.kpi-pill-neutral  { background: var(--cream-deep); color: var(--text-tertiary); }
.kpi-pill-success  { background: var(--jade-subtle); color: var(--jade); }
.kpi-pill-warning  { background: var(--warning-bg); color: var(--warning); }
.kpi-pill-danger   { background: var(--error-bg); color: var(--error); }
.kpi-pill-info     { background: rgba(37,99,235,.1); color: #2563EB; }
[data-theme="dark"] .kpi-pill-neutral { background: rgba(255,255,255,.08); }

/* Zone valeur principale */
.kpi-main {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

/* La valeur chiffrée */
.kpi-value {
  font-family: 'Instrument Serif', serif;
  font-size: 36px;
  letter-spacing: -.03em;
  color: var(--text-primary);
  line-height: 1;
}

/* Sous-texte de la valeur */
.kpi-sub {
  font-size: 12px;
  color: var(--text-tertiary);
  font-weight: 400;
  line-height: 1.4;
}


/* ============================================================
   2. STATUS CARDS (intégrations Airbnb/Booking/Stripe)
   ============================================================ */

/* Grid des status cards — fonctionne sur <section> aussi */
section.status-grid,
.status-cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

article.status-card {
  background: var(--cream-warm);
  border: 1px solid var(--border-warm);
  border-radius: var(--radius-lg);
  padding: 18px 20px;
  transition: transform .2s var(--ease-out), box-shadow .2s;
}
article.status-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-float);
}
[data-theme="dark"] article.status-card {
  background: #111827;
  border-color: rgba(255,255,255,.07);
}

.status-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
}

/* Icône de la plateforme */
.status-icon {
  width: 40px; height: 40px;
  border-radius: var(--radius-sm);
  display: flex; align-items: center; justify-content: center;
  font-size: 20px;
  flex-shrink: 0;
}
.status-icon-airbnb  { background: rgba(255,90,95,.12); color: #FF5A5F; }
.status-icon-booking { background: rgba(0,53,128,.12); color: #003580; }
.status-icon-stripe  { background: rgba(99,91,255,.12); color: #635BFF; }
.status-icon-direct  { background: var(--jade-glow); color: var(--jade); }

/* Label statut (connecté / non connecté) */
.status-label {
  font-size: 11px;
  font-weight: 700;
  padding: 3px 10px;
  border-radius: var(--radius-full);
  text-transform: uppercase;
  letter-spacing: .06em;
}
.status-ok      { background: var(--jade-subtle); color: var(--jade); }
.status-warning { background: var(--warning-bg); color: var(--warning); }
.status-error   { background: var(--error-bg); color: var(--error); }

article.status-card h3 {
  font-size: 16px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0 0 5px;
}
article.status-card p {
  font-size: 13px;
  color: var(--text-secondary);
  margin: 0 0 14px;
  line-height: 1.5;
}


/* ============================================================
   3. SECTION HEADERS
   ============================================================ */

.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
  gap: 12px;
}

.section-title {
  font-family: 'Instrument Serif', serif;
  font-size: 20px;
  font-weight: 400;
  letter-spacing: -.02em;
  color: var(--text-primary);
  margin: 0;
}

.section-kicker {
  font-size: 10.5px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .1em;
  color: var(--text-tertiary);
  margin-bottom: 4px;
}


/* ============================================================
   4. MODALS — structure générique
   ============================================================ */

/* Overlay + positionnement */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 9000;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,.5);
  backdrop-filter: blur(4px);
  padding: 20px;
}
.modal.active,
.modal[style*="flex"],
.modal[style*="block"] {
  display: flex;
}

/* Boite du modal */
.modal-box,
.modal-dialog,
.modal .modal-content {
  background: var(--cream-warm);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  max-width: 580px;
  width: 100%;
  max-height: 90vh;
  overflow: auto;
  animation: modalIn .3s var(--ease-out);
  position: relative;
}
[data-theme="dark"] .modal-box,
[data-theme="dark"] .modal-dialog,
[data-theme="dark"] .modal .modal-content {
  background: #1C2333;
}

/* Titre du modal */
.modal-title {
  font-size: 18px;
  font-weight: 700;
  color: var(--text-primary);
  margin: 0;
}

/* Bouton fermer */
.close-modal-btn {
  width: 32px; height: 32px;
  border-radius: var(--radius-full);
  border: 1px solid var(--border-color);
  background: var(--cream-deep);
  color: var(--text-secondary);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 13px;
  transition: all .15s;
  flex-shrink: 0;
}
.close-modal-btn:hover {
  background: var(--border-color);
  color: var(--text-primary);
}

/* Form dans modal */
.form-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}
.form-actions {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 10px;
  padding-top: 20px;
  margin-top: 20px;
  border-top: 1px solid var(--border-color);
}

/* Margin utilitaire manquant */
.mb-lg { margin-bottom: 24px; }


/* ============================================================
   5. CALENDAR HEADER — correction fond noir + view tabs
   ============================================================ */

/* Wrapper global du calendrier */
.calendar-wrapper {
  border-radius: var(--radius-xl);
  overflow: hidden;
  border: 1px solid var(--border-warm);
  box-shadow: var(--shadow-card);
  margin-bottom: 24px;
}

/* Le header principal du calendrier (fond obsidian) */
.calendar-modern-header {
  background: var(--obsidian);
  color: white;
}
[data-theme="dark"] .calendar-modern-header { background: #060D16; }

/* Header top : titre + actions — hauteur fixe, pas de débordement */
.calendar-header-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 20px;
  border-bottom: 1px solid rgba(255,255,255,.1);
  min-height: 0;
}

/* Zone view selector — compact, bien délimité */
.view-selector {
  display: flex;
  align-items: center;
  padding: 8px 14px;
  gap: 8px;
  background: var(--obsidian);
}
[data-theme="dark"] .view-selector { background: #060D16; }

/* Les onglets Jour/Semaine/Mois/Année */
.view-tabs {
  display: flex;
  gap: 4px;
  background: rgba(255,255,255,.08);
  border-radius: var(--radius-sm);
  padding: 4px;
  margin-left: auto;
}

.view-tab {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 5px 12px;
  border-radius: var(--radius-xs);
  border: none;
  background: transparent;
  color: rgba(255,255,255,.55);
  font-family: 'DM Sans', sans-serif;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all .15s;
  white-space: nowrap;
}
.view-tab:hover { background: rgba(255,255,255,.12); color: rgba(255,255,255,.9); }
.view-tab.active {
  background: var(--jade);
  color: white;
  font-weight: 600;
}

/* Titre calendrier dans le header obsidian */
.calendar-title-modern {
  font-family: 'Instrument Serif', serif;
  font-size: 18px;
  color: white;
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 400;
  letter-spacing: -.01em;
  margin: 0;
}
.calendar-title-modern i { font-size: 16px; opacity: .8; }

/* Boutons d'action dans le header calendrier */
.calendar-action-btn {
  width: 32px; height: 32px;
  background: rgba(255,255,255,.1);
  border: 1px solid rgba(255,255,255,.15);
  border-radius: var(--radius-sm);
  color: rgba(255,255,255,.75);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 12px;
  transition: background .15s;
}
.calendar-action-btn:hover {
  background: rgba(255,255,255,.2);
  color: white;
}

/* Navigation de période — fond cream, visible */
.period-navigation {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 20px;
  background: var(--cream-deep);
  border-bottom: 2px solid var(--border-color);
}
[data-theme="dark"] .period-navigation {
  background: #0D1117;
  border-color: rgba(255,255,255,.07);
}

.period-nav-btn {
  width: 32px; height: 32px;
  border-radius: var(--radius-xs);
  border: 1px solid var(--border-color);
  background: var(--cream-warm);
  color: var(--text-secondary);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 11px;
  transition: all .15s;
  font-family: 'DM Sans', sans-serif;
}
.period-nav-btn:hover {
  border-color: var(--jade);
  color: var(--jade);
  background: var(--jade-subtle);
}

.period-display {
  display: flex;
  align-items: baseline;
  gap: 6px;
}
.period-display .month-name {
  font-family: 'Instrument Serif', serif;
  font-size: 20px;
  letter-spacing: -.02em;
  color: var(--text-primary);
}
.period-display .year {
  font-size: 14px;
  font-weight: 600;
  color: var(--text-tertiary);
}


/* ============================================================
   6. MAIN HEADER — dans #bhHeader ou directement
   ============================================================ */

#bhHeader {
  padding: 0 24px;
  margin-bottom: 0;
}

#bhHeader header.main-header,
header.main-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  padding: 20px 24px;
  background: var(--cream-warm);
  border: 1px solid var(--border-warm);
  border-radius: var(--radius-lg);
  margin-bottom: 24px;
  box-shadow: var(--shadow-sm);
  gap: 16px;
}
[data-theme="dark"] #bhHeader header.main-header,
[data-theme="dark"] header.main-header {
  background: #111827;
  border-color: rgba(255,255,255,.07);
}

.page-kicker {
  font-size: 10.5px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: .12em;
  color: var(--text-tertiary);
  margin-bottom: 4px;
}
h1.page-title {
  font-family: 'Instrument Serif', serif;
  font-size: 26px;
  font-weight: 400;
  letter-spacing: -.025em;
  color: var(--text-primary);
  margin: 0 0 5px;
  line-height: 1.2;
}
.page-subtitle {
  font-size: 13px;
  color: var(--text-tertiary);
  margin: 0;
  line-height: 1.5;
}

.header-left { flex: 1; }
.header-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-shrink: 0;
  padding-top: 4px;
}

@media (max-width: 1024px) {
  #bhHeader { padding: 0 12px; }
  #bhHeader header.main-header,
  header.main-header {
    flex-direction: column;
    gap: 12px;
    margin-bottom: 16px;
    padding: 14px 16px;
  }
  h1.page-title { font-size: 22px; }
  .page-subtitle { display: none; }
  .header-actions { width: 100%; }
}


/* ============================================================
   7. PAGE CONTENT — padding et layout général
   ============================================================ */

/* Avec le sous-menu, le main-content prend toute la largeur */
body.with-subnav main.main-content {
  margin-left: 0;
  width: 100%;
}

main.main-content {
  margin-left: 0;
  flex: 1;
  min-height: 100dvh;
  background: var(--bg-primary);
  width: 100%;
}
[data-theme="dark"] main.main-content { background: var(--bg-primary); }

div.page-content {
  padding: 0 24px 60px;
  max-width: 1600px;
  margin: 0 auto;
}

/* Sur mobile */
@media (max-width: 1024px) {
  main.main-content { margin-left: 0; }
  div.page-content  { padding: 0 12px 100px; }
  .form-grid { grid-template-columns: 1fr; }
  .status-cards-grid { grid-template-columns: 1fr 1fr; }
}

@media (max-width: 640px) {
  .status-cards-grid { grid-template-columns: 1fr; }
  .kpi-grid-section  { grid-template-columns: 1fr 1fr; }
  .view-tab span { display: none; }
}


/* ============================================================
   8. APP CONTAINER
   ============================================================ */

div.app-container {
  display: block;
  min-height: 100dvh;
  width: 100%;
}
