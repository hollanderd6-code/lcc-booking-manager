<!DOCTYPE html>
<html data-theme="light" lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>Boostinghost - Espace Sous-Compte</title>

<!-- ============================================ -->
<!-- üîê V√âRIFICATION AUTH SOUS-COMPTE UNIQUEMENT -->
<!-- ============================================ -->
<script>
console.log('üîê SUB-ACCOUNT PAGE - Auth Check');

const IS_NATIVE = (() => {
  try {
    return !!(
      window.Capacitor?.isNativePlatform?.() ||
      window.location.protocol === 'capacitor:' ||
      window.location.protocol === 'ionic:'
    );
  } catch (e) {
    return false;
  }
})();

const API_BASE = IS_NATIVE ? 'https://lcc-booking-manager.onrender.com' : '';

// V√©rifier que c'est bien un sous-compte
const token = localStorage.getItem('lcc_token');
const accountType = localStorage.getItem('lcc_account_type');

if (!token) {
  console.log('‚ùå Pas de token');
  window.location.href = IS_NATIVE ? 'login.html' : '/login.html';
} else if (accountType !== 'sub') {
  console.log('‚ö†Ô∏è Compte principal d√©tect√© - Redirection vers app.html');
  window.location.href = IS_NATIVE ? 'app.html' : '/app.html';
} else {
  console.log('‚úÖ Sous-compte d√©tect√© - Chargement de l\'interface');
}

// Charger les infos utilisateur
let currentUser = {};
let permissions = {};
try {
  const userData = localStorage.getItem('lcc_user');
  const permData = localStorage.getItem('lcc_permissions');
  if (userData) currentUser = JSON.parse(userData);
  if (permData) permissions = JSON.parse(permData);
  console.log('üë§ Utilisateur:', currentUser.name || currentUser.email);
  console.log('üîê Permissions:', permissions);
} catch (e) {
  console.error('Erreur chargement donn√©es:', e);
}
</script>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"/>
<!-- CSS plateforme -->
<link href="/css/style.css?v=3" rel="stylesheet"/>
<link href="/css/bh-shared.css?v=1" rel="stylesheet"/>
<link href="/css/bottom-bar-enhanced.css" rel="stylesheet"/>
<link rel="stylesheet" href="/css/dark-mode.css">

<style>
/* ===== LAYOUT SP√âCIFIQUE SOUS-COMPTE ===== */
.sub-account-badge {
  position: fixed;
  top: 20px;
  right: 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 10px 18px;
  border-radius: 25px;
  font-size: 13px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  z-index: 9999;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
  animation: fadeInDown 0.5s ease;
}

@keyframes fadeInDown {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.permissions-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 16px;
  margin-top: 20px;
}

.permission-card {
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  padding: 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  transition: all 0.2s ease;
}

.permission-card.enabled {
  border-color: #10B981;
  background: linear-gradient(to right, #f0fdf4, #ffffff);
}

.permission-card.disabled {
  opacity: 0.5;
  background: #f9fafb;
}

.permission-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  flex-shrink: 0;
}

.permission-card.enabled .permission-icon {
  background: linear-gradient(135deg, #10B981, #059669);
  color: white;
}

.permission-card.disabled .permission-icon {
  background: #e5e7eb;
  color: #9ca3af;
}

.permission-info {
  flex: 1;
}

.permission-title {
  font-weight: 600;
  font-size: 14px;
  color: #111827;
  margin-bottom: 2px;
}

.permission-desc {
  font-size: 12px;
  color: #6b7280;
}

/* Message d'info */
.info-banner {
  background: linear-gradient(135deg, #3B82F6, #2563EB);
  color: white;
  padding: 16px 20px;
  border-radius: 12px;
  margin-bottom: 24px;
  display: flex;
  align-items: center;
  gap: 12px;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
}

.info-banner i {
  font-size: 24px;
  opacity: 0.9;
}

.info-banner-content h3 {
  margin: 0 0 4px 0;
  font-size: 16px;
  font-weight: 700;
}

.info-banner-content p {
  margin: 0;
  font-size: 13px;
  opacity: 0.95;
}

/* Menu quick actions */
.quick-actions {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 24px;
}

.quick-action-btn {
  background: white;
  border: 2px solid #e5e7eb;
  border-radius: 12px;
  padding: 20px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
  text-decoration: none;
  color: inherit;
  display: block;
}

.quick-action-btn:hover {
  border-color: #10B981;
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(16, 185, 129, 0.15);
}

.quick-action-btn i {
  font-size: 32px;
  color: #10B981;
  margin-bottom: 12px;
}

.quick-action-btn .title {
  font-weight: 600;
  font-size: 15px;
  color: #111827;
  margin-bottom: 4px;
}

.quick-action-btn .subtitle {
  font-size: 12px;
  color: #6b7280;
}

.quick-action-btn.disabled {
  opacity: 0.4;
  pointer-events: none;
}

/* Responsive */
@media (max-width: 768px) {
  .sub-account-badge {
    top: 10px;
    right: 10px;
    font-size: 11px;
    padding: 8px 14px;
  }
  
  .permissions-list {
    grid-template-columns: 1fr;
  }
  
  .quick-actions {
    grid-template-columns: repeat(2, 1fr);
  }
}
</style>
</head>

<body>
<!-- Container -->
<div class="app-container">

<!-- Sidebar -->
<aside class="sidebar">
  <div class="sidebar-header">
    <a class="sidebar-logo" href="/sub-account.html">
      <img src="/asset/boostinghost-icon-circle.png" alt="Boostinghost" style="width:40px;height:40px;">
      <div class="sidebar-logo-text">
        <span class="sidebar-logo-title">
          <span style="color: #10B981; font-weight: 800;">Boosting</span><span style="color: #111827; font-weight: 600;">host</span>
        </span>
        <span class="sidebar-logo-subtitle">Espace Sous-Compte</span>
      </div>
    </a>
  </div>

  <nav class="sidebar-nav">
    <!-- PRINCIPAL -->
    <div class="nav-section">
      <div class="nav-section-title">Principal</div>
      <a class="nav-item active" href="/sub-account.html">
        <i class="fas fa-th-large"></i>
        <span>Dashboard</span>
      </a>
      <a class="nav-item" href="/messages.html" id="navMessages">
        <i class="fas fa-comment-dots"></i>
        <span>Messages</span>
      </a>
    </div>

    <!-- GESTION - selon permissions -->
    <div class="nav-section" id="navGestion">
      <div class="nav-section-title">Gestion</div>
      <a class="nav-item" href="/settings.html" id="navProperties">
        <i class="fas fa-home"></i>
        <span>Mes logements</span>
      </a>
      <a class="nav-item" href="/cleaning.html" id="navCleaning">
        <i class="fas fa-broom"></i>
        <span>Gestion du m√©nage</span>
      </a>
    </div>

    <!-- AIDE -->
    <div class="nav-section">
      <div class="nav-section-title">Support</div>
      <a class="nav-item" href="/help.html">
        <i class="fas fa-question-circle"></i>
        <span>Aide</span>
      </a>
    </div>
  </nav>

  <div class="sidebar-footer">
    <div class="user-profile">
      <div class="user-avatar" id="userAvatar">U</div>
      <div class="user-info">
        <div class="user-name" id="userName">Sous-compte</div>
        <div class="user-email" id="userEmail">email@example.com</div>
      </div>
      <button class="btn btn-ghost btn-xs" id="logoutBtn" title="D√©connexion">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    </div>
  </div>
</aside>

<!-- Main Content -->
<main class="main-content">
  <!-- Header -->
  <header class="main-header">
    <div class="header-left">
      <div class="page-kicker">Espace collaborateur</div>
      <h1 class="page-title">Tableau de bord</h1>
      <p class="page-subtitle" id="welcomeMessage">
        Bienvenue dans votre espace de travail
      </p>
    </div>
  </header>

  <div class="page-content">
    
    <!-- Badge sous-compte (visible uniquement sur desktop) -->
    <div class="sub-account-badge" style="display: none;" id="desktopBadge">
      <i class="fas fa-user-shield"></i>
      <span id="badgeName">Sous-compte</span>
    </div>

    <!-- Info Banner -->
    <div class="info-banner">
      <i class="fas fa-info-circle"></i>
      <div class="info-banner-content">
        <h3>Compte limit√©</h3>
        <p>Vous utilisez un compte avec permissions restreintes. Certaines fonctionnalit√©s peuvent √™tre d√©sactiv√©es.</p>
      </div>
    </div>

    <!-- Quick Actions -->
    <section class="card">
      <h2 style="margin-bottom: 4px;">Actions rapides</h2>
      <p style="color: #6b7280; font-size: 14px; margin-bottom: 20px;">Acc√©dez rapidement aux fonctionnalit√©s disponibles</p>
      
      <div class="quick-actions" id="quickActionsGrid">
        <!-- G√©n√©r√© dynamiquement -->
      </div>
    </section>

    <!-- Permissions -->
    <section class="card">
      <h2 style="margin-bottom: 4px;">Vos permissions</h2>
      <p style="color: #6b7280; font-size: 14px; margin-bottom: 20px;">D√©tail des acc√®s autoris√©s sur votre compte</p>
      
      <div class="permissions-list" id="permissionsList">
        <!-- G√©n√©r√© dynamiquement -->
      </div>
    </section>

  </div>
</main>

</div>

<!-- ============================================ -->
<!-- SCRIPTS -->
<!-- ============================================ -->
<script>
// ===== DONN√âES GLOBALES =====
const token = localStorage.getItem('lcc_token');
let userData = {};
let permissions = {};

// Charger les donn√©es avec debug
try {
  const userDataStr = localStorage.getItem('lcc_user');
  const permissionsStr = localStorage.getItem('lcc_permissions');
  
  console.log('üì¶ localStorage.lcc_user:', userDataStr);
  console.log('üì¶ localStorage.lcc_permissions:', permissionsStr);
  
  if (userDataStr) {
    userData = JSON.parse(userDataStr);
  }
  
  if (permissionsStr) {
    permissions = JSON.parse(permissionsStr);
  }
  
  console.log('‚úÖ Donn√©es pars√©es:', { userData, permissions });
} catch (e) {
  console.error('‚ùå Erreur parsing donn√©es:', e);
}

// V√©rifier qu'on a bien des donn√©es
if (!token || Object.keys(userData).length === 0) {
  console.error('‚ùå Donn√©es manquantes, rechargement depuis le serveur...');
  // Tenter de recharger
  fetch('/api/auth/verify', {
    headers: { 'Authorization': `Bearer ${token}` }
  })
  .then(r => r.json())
  .then(data => {
    if (data.accountType === 'sub') {
      localStorage.setItem('lcc_user', JSON.stringify(data.subAccount));
      localStorage.setItem('lcc_permissions', JSON.stringify(data.permissions));
      location.reload();
    }
  })
  .catch(err => console.error('‚ùå Erreur rechargement:', err));
}

// ===== INITIALISATION UI =====
document.addEventListener('DOMContentLoaded', function() {
  
  console.log('üöÄ Initialisation interface sous-compte');
  
  // ===== 1. AFFICHER LES INFOS UTILISATEUR =====
  const firstName = userData.first_name || userData.firstName || '';
  const lastName = userData.last_name || userData.lastName || '';
  const email = userData.email || '';
  const fullName = `${firstName} ${lastName}`.trim() || email || 'Sous-compte';
  
  console.log('üë§ Infos utilisateur:', { firstName, lastName, email, fullName });
  
  // Afficher le nom complet
  document.getElementById('userName').textContent = fullName;
  document.getElementById('userEmail').textContent = email;
  document.getElementById('badgeName').textContent = fullName;
  document.getElementById('welcomeMessage').textContent = `Bienvenue, ${firstName || email.split('@')[0]}`;
  document.getElementById('desktopBadge').style.display = 'flex';
  
  // Initiales (2 premi√®res lettres)
  let initials = 'U';
  if (firstName && lastName) {
    initials = `${firstName.charAt(0)}${lastName.charAt(0)}`.toUpperCase();
  } else if (fullName) {
    const words = fullName.split(' ');
    if (words.length >= 2) {
      initials = `${words[0].charAt(0)}${words[1].charAt(0)}`.toUpperCase();
    } else {
      initials = fullName.substring(0, 2).toUpperCase();
    }
  }
  
  console.log('üî§ Initiales:', initials);
  document.getElementById('userAvatar').textContent = initials;
  
  // ===== 2. G√âN√âRER LES QUICK ACTIONS =====
  const quickActions = [
    {
      icon: 'fa-comment-dots',
      title: 'Messages',
      subtitle: 'Conversations clients',
      link: '/messages.html',
      permission: 'can_view_messages'
    },
    {
      icon: 'fa-calendar',
      title: 'R√©servations',
      subtitle: 'Calendrier & s√©jours',
      link: '/app.html#calendar',
      permission: 'can_view_reservations'
    },
    {
      icon: 'fa-home',
      title: 'Logements',
      subtitle: 'G√©rer les propri√©t√©s',
      link: '/settings.html',
      permission: 'can_view_properties'
    },
    {
      icon: 'fa-broom',
      title: 'M√©nages',
      subtitle: 'Planning nettoyage',
      link: '/cleaning.html',
      permission: 'can_view_cleaning'
    },
    {
      icon: 'fa-shield-alt',
      title: 'Cautions',
      subtitle: 'G√©rer les d√©p√¥ts',
      link: '/deposits.html',
      permission: 'can_view_deposits'
    },
    {
      icon: 'fa-lock',
      title: 'Serrures',
      subtitle: 'Acc√®s connect√©s',
      link: '/smart-locks.html',
      permission: 'can_manage_locks'
    }
  ];
  
  const quickActionsGrid = document.getElementById('quickActionsGrid');
  const enabledActions = quickActions.filter(action => permissions[action.permission] === true);
  
  console.log('üéØ Quick actions filtr√©es:', enabledActions.length, '/', quickActions.length);
  
  if (enabledActions.length === 0) {
    quickActionsGrid.innerHTML = `
      <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #9ca3af;">
        <i class="fas fa-lock" style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;"></i>
        <p>Aucune fonctionnalit√© autoris√©e</p>
        <p style="font-size: 13px;">Contactez l'administrateur pour obtenir des permissions</p>
      </div>
    `;
  } else {
    quickActionsGrid.innerHTML = enabledActions.map(action => `
      <a href="${action.link}" class="quick-action-btn">
        <i class="fas ${action.icon}"></i>
        <div class="title">${action.title}</div>
        <div class="subtitle">${action.subtitle}</div>
      </a>
    `).join('');
  }
  
  // ===== 3. G√âN√âRER LA LISTE DES PERMISSIONS =====
  const permissionsList = [
    { key: 'can_view_reservations', icon: 'fa-calendar', title: 'Voir les r√©servations', desc: 'Acc√®s au calendrier et aux s√©jours' },
    { key: 'can_edit_reservations', icon: 'fa-edit', title: 'Modifier les r√©servations', desc: '√âditer les d√©tails des s√©jours' },
    { key: 'can_view_properties', icon: 'fa-home', title: 'Voir les logements', desc: 'Acc√®s √† la liste des propri√©t√©s' },
    { key: 'can_edit_properties', icon: 'fa-cog', title: 'Modifier les logements', desc: '√âditer les param√®tres des propri√©t√©s' },
    { key: 'can_view_messages', icon: 'fa-comment-dots', title: 'Voir les messages', desc: 'Acc√®s aux conversations clients' },
    { key: 'can_send_messages', icon: 'fa-paper-plane', title: 'Envoyer des messages', desc: 'R√©pondre aux clients' },
    { key: 'can_view_cleaning', icon: 'fa-broom', title: 'Voir les m√©nages', desc: 'Acc√®s au planning de nettoyage' },
    { key: 'can_manage_cleaning', icon: 'fa-tasks', title: 'G√©rer les m√©nages', desc: 'Cr√©er et modifier les t√¢ches' },
    { key: 'can_manage_team', icon: 'fa-users', title: 'G√©rer l\'√©quipe', desc: 'Administrer les sous-comptes' },
    { key: 'can_view_deposits', icon: 'fa-shield-alt', title: 'Voir les cautions', desc: 'Acc√®s aux cautions clients' },
    { key: 'can_manage_locks', icon: 'fa-lock', title: 'G√©rer les serrures', desc: 'Contr√¥ler les serrures connect√©es' }
  ];
  
  const permissionsListEl = document.getElementById('permissionsList');
  permissionsListEl.innerHTML = permissionsList.map(perm => {
    const isEnabled = permissions[perm.key] === true;
    return `
      <div class="permission-card ${isEnabled ? 'enabled' : 'disabled'}">
        <div class="permission-icon">
          <i class="fas ${perm.icon}"></i>
        </div>
        <div class="permission-info">
          <div class="permission-title">${perm.title}</div>
          <div class="permission-desc">${perm.desc}</div>
        </div>
        <i class="fas ${isEnabled ? 'fa-check-circle' : 'fa-times-circle'}" style="color: ${isEnabled ? '#10B981' : '#9ca3af'}; font-size: 20px;"></i>
      </div>
    `;
  }).join('');
  
  // ===== 4. FILTRER LE MENU SIDEBAR =====
  console.log('üîß Filtrage du menu sidebar...');
  
  // Messages
  if (!permissions.can_view_messages) {
    const navMessages = document.getElementById('navMessages');
    if (navMessages) {
      navMessages.style.display = 'none';
      console.log('  üö´ Menu Messages masqu√©');
    }
  }
  
  // Logements
  if (!permissions.can_view_properties) {
    const navProperties = document.getElementById('navProperties');
    if (navProperties) {
      navProperties.style.display = 'none';
      console.log('  üö´ Menu Logements masqu√©');
    }
  }
  
  // M√©nage
  if (!permissions.can_view_cleaning) {
    const navCleaning = document.getElementById('navCleaning');
    if (navCleaning) {
      navCleaning.style.display = 'none';
      console.log('  üö´ Menu M√©nages masqu√©');
    }
  }
  
  // Masquer section Gestion si aucune permission
  if (!permissions.can_view_properties && !permissions.can_view_cleaning) {
    const navGestion = document.getElementById('navGestion');
    if (navGestion) {
      navGestion.style.display = 'none';
      console.log('  üö´ Section Gestion masqu√©e');
    }
  }
  
  // ===== 5. LOGOUT =====
  document.getElementById('logoutBtn').addEventListener('click', function() {
    if (confirm('Voulez-vous vraiment vous d√©connecter ?')) {
      localStorage.removeItem('lcc_token');
      localStorage.removeItem('lcc_account_type');
      localStorage.removeItem('lcc_user');
      localStorage.removeItem('lcc_permissions');
      window.location.href = '/login.html';
    }
  });
  
  console.log('‚úÖ Interface sous-compte initialis√©e');
});
</script>

</body>
</html>
  
  // Afficher les infos utilisateur
  const userName = userData.name || userData.email || 'Sous-compte';
  const userEmail = userData.email || '';
  
  document.getElementById('userName').textContent = userName;
  document.getElementById('userEmail').textContent = userEmail;
  document.getElementById('badgeName').textContent = userName;
  document.getElementById('welcomeMessage').textContent = `Bienvenue, ${userName.split(' ')[0]}`;
  document.getElementById('desktopBadge').style.display = 'flex';
  
  // Avatar initial
  const initial = userName.charAt(0).toUpperCase();
  document.getElementById('userAvatar').textContent = initial;
  
  // ===== G√âN√âRER LES QUICK ACTIONS =====
  const quickActions = [
    {
      icon: 'fa-comment-dots',
      title: 'Messages',
      subtitle: 'Conversations clients',
      link: '/messages.html',
      permission: 'can_view_messages'
    },
    {
      icon: 'fa-calendar',
      title: 'R√©servations',
      subtitle: 'Calendrier & s√©jours',
      link: '/app.html#calendar',
      permission: 'can_view_reservations'
    },
    {
      icon: 'fa-home',
      title: 'Logements',
      subtitle: 'G√©rer les propri√©t√©s',
      link: '/settings.html',
      permission: 'can_view_properties'
    },
    {
      icon: 'fa-broom',
      title: 'M√©nages',
      subtitle: 'Planning nettoyage',
      link: '/cleaning.html',
      permission: 'can_view_cleaning'
    }
  ];
  
  const quickActionsGrid = document.getElementById('quickActionsGrid');
  quickActionsGrid.innerHTML = quickActions.map(action => {
    const isEnabled = permissions[action.permission] === true;
    return `
      <a href="${action.link}" class="quick-action-btn ${!isEnabled ? 'disabled' : ''}">
        <i class="fas ${action.icon}"></i>
        <div class="title">${action.title}</div>
        <div class="subtitle">${action.subtitle}</div>
      </a>
    `;
  }).join('');
  
  // ===== G√âN√âRER LA LISTE DES PERMISSIONS =====
  const permissionsList = [
    { key: 'can_view_reservations', icon: 'fa-calendar', title: 'Voir les r√©servations', desc: 'Acc√®s au calendrier et aux s√©jours' },
    { key: 'can_edit_reservations', icon: 'fa-edit', title: 'Modifier les r√©servations', desc: '√âditer les d√©tails des s√©jours' },
    { key: 'can_view_properties', icon: 'fa-home', title: 'Voir les logements', desc: 'Acc√®s √† la liste des propri√©t√©s' },
    { key: 'can_edit_properties', icon: 'fa-cog', title: 'Modifier les logements', desc: '√âditer les param√®tres des propri√©t√©s' },
    { key: 'can_view_messages', icon: 'fa-comment-dots', title: 'Voir les messages', desc: 'Acc√®s aux conversations clients' },
    { key: 'can_send_messages', icon: 'fa-paper-plane', title: 'Envoyer des messages', desc: 'R√©pondre aux clients' },
    { key: 'can_view_cleaning', icon: 'fa-broom', title: 'Voir les m√©nages', desc: 'Acc√®s au planning de nettoyage' },
    { key: 'can_manage_cleaning', icon: 'fa-tasks', title: 'G√©rer les m√©nages', desc: 'Cr√©er et modifier les t√¢ches' },
    { key: 'can_manage_team', icon: 'fa-users', title: 'G√©rer l\'√©quipe', desc: 'Administrer les sous-comptes' }
  ];
  
  const permissionsListEl = document.getElementById('permissionsList');
  permissionsListEl.innerHTML = permissionsList.map(perm => {
    const isEnabled = permissions[perm.key] === true;
    return `
      <div class="permission-card ${isEnabled ? 'enabled' : 'disabled'}">
        <div class="permission-icon">
          <i class="fas ${perm.icon}"></i>
        </div>
        <div class="permission-info">
          <div class="permission-title">${perm.title}</div>
          <div class="permission-desc">${perm.desc}</div>
        </div>
        <i class="fas ${isEnabled ? 'fa-check-circle' : 'fa-times-circle'}" style="color: ${isEnabled ? '#10B981' : '#9ca3af'}; font-size: 20px;"></i>
      </div>
    `;
  }).join('');
  
  // ===== FILTRER LE MENU SELON PERMISSIONS =====
  
  // Messages
  if (!permissions.can_view_messages) {
    const navMessages = document.getElementById('navMessages');
    if (navMessages) navMessages.style.display = 'none';
  }
  
  // Logements
  if (!permissions.can_view_properties) {
    const navProperties = document.getElementById('navProperties');
    if (navProperties) navProperties.style.display = 'none';
  }
  
  // M√©nage
  if (!permissions.can_view_cleaning) {
    const navCleaning = document.getElementById('navCleaning');
    if (navCleaning) navCleaning.style.display = 'none';
  }
  
  // Masquer section Gestion si aucune permission
  if (!permissions.can_view_properties && !permissions.can_view_cleaning) {
    const navGestion = document.getElementById('navGestion');
    if (navGestion) navGestion.style.display = 'none';
  }
  
  // ===== LOGOUT =====
  document.getElementById('logoutBtn').addEventListener('click', function() {
    if (confirm('Voulez-vous vraiment vous d√©connecter ?')) {
      localStorage.removeItem('lcc_token');
      localStorage.removeItem('lcc_account_type');
      localStorage.removeItem('lcc_user');
      localStorage.removeItem('lcc_permissions');
      window.location.href = '/login.html';
    }
  });
  
  console.log('‚úÖ Interface sous-compte initialis√©e');
});
</script>

</body>
</html>
